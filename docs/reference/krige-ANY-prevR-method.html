<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spatial interpolation (kriging and inverse distance weighting) for objects of class prevR. — krige,ANY,prevR-method • prevR</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Spatial interpolation (kriging and inverse distance weighting) for objects of class prevR. — krige,ANY,prevR-method" />

<meta property="og:description" content="These functions execute a spatial interpolation of a variable of the slot rings of 
an object of class prevR. The method krige implements 
the ordinary kriging technique. The method idw executes an inverse distance weighting 
interpolation." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prevR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/intro_prevR.html">Introduction to prevR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/larmarange/prevR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial interpolation (kriging and inverse distance weighting) for objects of class prevR.</h1>
    <small class="dont-index">Source: <a href='https://github.com/larmarange/prevR/blob/master/R/krige.prevR.r'><code>R/krige.prevR.r</code></a></small>
    <div class="hidden name"><code>krige-ANY-prevR-method.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>These functions execute a spatial interpolation of a variable of the slot <code>rings</code> of 
an object of class <code><a href='prevR-class.html'>prevR</a></code>. The method <code>krige</code> implements 
the ordinary kriging technique. The method <code>idw</code> executes an inverse distance weighting 
interpolation.</p>
    
    </div>

    <pre class="usage"><span class='co'># S4 method for ANY,prevR</span>
<span class='fu'>krige</span>(<span class='no'>formula</span>, <span class='no'>locations</span>, <span class='kw'>N</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>model</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nb.cells</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>cell.size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>fit</span> <span class='kw'>=</span> <span class='st'>"auto"</span>,
  <span class='kw'>keep.variance</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>show.variogram</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='co'># S4 method for ANY,prevR</span>
<span class='fu'>idw</span>(<span class='no'>formula</span>, <span class='no'>locations</span>, <span class='kw'>N</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>Inf</span>,
  <span class='kw'>nb.cells</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>cell.size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>idp</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>variable(s) to interpolate (see details).</p></td>
    </tr>
    <tr>
      <th>locations</th>
      <td><p>object of class <code><a href='prevR-class.html'>prevR</a></code>.</p></td>
    </tr>
    <tr>
      <th>N</th>
      <td><p>integer or list of integers corresponding to the rings to use.</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>integer or list of integers corresponding to the rings to use.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>a variogram model returned by the function <code><a href='https://www.rdocumentation.org/packages/gstat/topics/vgm'>vgm</a></code>{<span class="pkg">gstat</span>}.</p></td>
    </tr>
    <tr>
      <th>nb.cells</th>
      <td><p>number of cells on the longuest side of the studied area 
(unused if <code>cell.size</code> is defined).</p></td>
    </tr>
    <tr>
      <th>cell.size</th>
      <td><p>size of each cell (in the unit of the projection).</p></td>
    </tr>
    <tr>
      <th>fit</th>
      <td><p>"auto" for using a variogram automatically fitted from the data, 
"manual" for using a variogram fitted through a graphic interface 
(unused if <code>model</code> is defined).</p></td>
    </tr>
    <tr>
      <th>keep.variance</th>
      <td><p>return variance of estimates?</p></td>
    </tr>
    <tr>
      <th>show.variogram</th>
      <td><p>plot the variogram?</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>additional arguments transmited to <code><a href='https://www.rdocumentation.org/packages/gstat/topics/krige'>krige</a></code>{<span class="pkg">gstat</span>} 
or <code><a href='https://www.rdocumentation.org/packages/gstat/topics/krige'>idw</a></code>{<span class="pkg">gstat</span>}.</p></td>
    </tr>
    <tr>
      <th>idp</th>
      <td><p>inverse distance weighting power (see <code><a href='https://www.rdocumentation.org/packages/gstat/topics/krige'>idw</a></code>{<span class="pkg">gstat</span>}).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Object of class <code><a href='https://www.rdocumentation.org/packages/sp/topics/SpatialPixelsDataFrame-class'>SpatialPixelsDataFrame</a></code>. 
The name of estimated surfaces depends on the name of the interpolated variable, N and R 
(for example: <em>r.radius.N300.RInf</em>). If you ask the function to return variance 
(<code>keep.variance=TRUE</code>), corresponding surfaces names will have the suffix <em>.var</em>.</p>
<p><code>NA</code> value is applied to points located outside of the studied area <br />
(voir <code><a href='NA.outside.SpatialPolygons.html'>NA.outside.SpatialPolygons</a></code>).</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>formula</code> specifies the variable(s) to interpolate. Only variables available in the 
slot <code>rings</code> of <code>locations</code> could be used. Possible values are "r.pos", "r.n", "r.prev", 
"r.radius", "r.clusters", "r.wpos", "r.wn" ou "r.wprev". Variables could be specifed with a character 
string or a formula (example: <code>list(r.pos~1,r.prev~1</code>). Only formula like <code>variable.name~1</code> 
are accepted. For more complexe interpolations, use directly functions <code><a href='https://www.rdocumentation.org/packages/gstat/topics/krige'>krige</a></code> and
<code><a href='https://www.rdocumentation.org/packages/gstat/topics/krige'>idw</a></code> from <span class="pkg">gstat</span>.</p>
<p><code>N</code> and <code>R</code> determine the rings to use for the interpolation. If they are not defined, 
surfaces will be estimated for each available couples (N,R). Several interpolations could be 
simultaneously calculated if several variables and/or several values of N and R are defined.</p>
<p>A suggested value of N could be computed with <code><a href='Noptim.html'>Noptim</a></code>.</p>
<p>In the case of an ordinary kriging, the method <code>krige</code> from <span class="pkg">prevR</span> will try to fit automatically
a exponantial variogram to the sample variogram (<code>fit="auto"</code>). If you choose <code>fit="manual"</code>, 
the sample variogram will be plotted and a graphical dialog box (adapted from 
<code><a href='https://www.rdocumentation.org/packages/geoR/topics/eyefit'>eyefit</a></code>{<span class="pkg">geoR</span>}) will appear for a manual and visual fitting. You can also specify
directly the variogram to use with the parameter <code>model</code>. Packages <span class="pkg">geoR</span> and <span class="pkg">tcltk</span> 
are required for manual fit.</p>
<p>Interpolations are calculated on spatial gridd obtained with 
<code><a href='as.SpatialGrid.html'>as.SpatialGrid</a></code>.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Results could be plotted with <code><a href='https://www.rdocumentation.org/packages/sp/topics/spplot'>spplot</a></code>{<span class="pkg">sp</span>}.<br />
<span class="pkg">prevR</span> provides several continuous color palettes (see <code><a href='prevR.colors.html'>prevR.colors</a></code>) compatible 
with <code><a href='https://www.rdocumentation.org/packages/sp/topics/spplot'>spplot</a></code>.<br />
Calculated surfaces could be export using the function 
<code><a href='https://www.rdocumentation.org/packages/maptools/topics/asciigrid'>writeAsciiGrid</a></code>{<span class="pkg">maptools</span>}.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Larmarange Joseph, Vallo Roselyne, Yaro Seydou, Msellati Philippe and Meda Nicolas (2011) 
"Methods for mapping regional trends of HIV prevalence from Demographic and Health Surveys (DHS)", 
<em>Cybergeo: European Journal of Geography</em>, no 558, <a href='http://cybergeo.revues.org/24606'>http://cybergeo.revues.org/24606</a>, 
DOI: 10.4000/cybergeo.24606.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://www.rdocumentation.org/packages/gstat/topics/krige'>krige</a></code>{<span class="pkg">gstat</span>}, <code><a href='https://www.rdocumentation.org/packages/gstat/topics/krige'>idw</a></code>{<span class="pkg">gstat</span>}, 
<code><a href='rings-prevR-method.html'>rings,prevR-method</a></code>, <code><a href='Noptim.html'>Noptim</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>  </div><span class='co'># NOT RUN {</span>
    <span class='no'>dhs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rings-prevR-method.html'>rings</a></span>(<span class='no'>fdhs</span>, <span class='kw'>N</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>100</span>,<span class='fl'>200</span>,<span class='fl'>300</span>,<span class='fl'>400</span>,<span class='fl'>500</span>))
    <span class='no'>radius.N300</span> <span class='kw'>&lt;-</span> <span class='fu'>krige</span>(<span class='st'>'r.radius'</span>, <span class='no'>dhs</span>, <span class='kw'>N</span> <span class='kw'>=</span> <span class='fl'>300</span>, <span class='kw'>nb.cells</span> <span class='kw'>=</span> <span class='fl'>200</span>)
    <span class='no'>prev.krige</span> <span class='kw'>&lt;-</span> <span class='fu'>krige</span>(<span class='no'>r.wprev</span> ~ <span class='fl'>1</span>, <span class='no'>dhs</span>, <span class='kw'>N</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>100</span>, <span class='fl'>300</span>, <span class='fl'>500</span>))
    <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>sp</span>)
    <span class='fu'><a href='https://www.rdocumentation.org/packages/sp/topics/spplot'>spplot</a></span>(<span class='no'>prev.krige</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>'r.wprev.N100.RInf'</span>, <span class='st'>'r.wprev.N300.RInf'</span>, <span class='st'>'r.wprev.N500.RInf'</span>))

<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Joseph Larmarange.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

