<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to prevR • prevR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to prevR">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prevR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro_prevR.html">Introduction to prevR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/larmarange/prevR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to prevR</h1>
                        <h4 class="author">Joseph Larmarange</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/larmarange/prevR/blob/master/vignettes/intro_prevR.Rmd"><code>vignettes/intro_prevR.Rmd</code></a></small>
      <div class="hidden name"><code>intro_prevR.Rmd</code></div>

    </div>

    
    
<p>This package performs a methodological approach for spatial estimation of regional trends of a prevalence using data from surveys using a stratified two-stage sample design (as Demographic and Health Surveys). In these kind of surveys, positive and control cases are spatially positioned at the centre of their corresponding surveyed cluster.</p>
<p>This package provides functions to estimate a prevalence surface using a kernel estimator with adaptative bandwiths of equal number of persons surveyed (a variant of the nearest neighbour technique) or with fixed bandwiths. The prevalence surface could also be calculated using a spatial interpolation (kriging or inverse distance weighting) after a moving average smoothing based on circles of equal number of observed persons or circles of equal radius.</p>
<p>With the kernel estimator approach, it’s also possible to estimate a surface of relative risks.</p>
<p>The methodological approach has been described in:</p>
<ul>
<li>Larmarange Joseph, Vallo Roselyne, Yaro Seydou, Msellati Philippe and Meda Nicolas (2011) “Methods for mapping regional trends of HIV prevalence from Demographic and Health Surveys (DHS)”, <em>Cybergeo: European Journal of Geography</em>, no 558, <a href="http://cybergeo.revues.org/24606" class="uri">http://cybergeo.revues.org/24606</a>, DOI: 10.4000/cybergeo.24606</li>
</ul>
<p>Application to generate HIV prevalence surfaces can be found at:</p>
<ul>
<li>Larmarange Joseph and Bendaud Victoria (2014) “HIV estimates at second subnational level from national population-based survey”, AIDS, n° 28, p. S469-S476, DOI: <a href="http://dx.doi.org/10.1097/QAD.0000000000000480">10.1097/QAD.0000000000000480</a>
</li>
</ul>
<p>Other papers using <strong>prevR</strong> could be found on <a href="https://scholar.google.fr/scholar?oi=bibs&amp;hl=fr&amp;cites=1938663060375810997,6018660907435103505">Google Scholar</a>.</p>
<div id="importing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#importing-data" class="anchor"></a>Importing data</h2>
<p>To create a <strong>prevR</strong> object, you need three elements:</p>
<ul>
<li>a data.frame with one row per survey cluster and containing the number of observations, the number of positive cases and coordinates of the cluster (you could optionnaly use weighted numbers)</li>
<li>a vector identifying the columns of the data.frame containing the correspondant variables</li>
<li>an optional <code>SpatialPolygons</code> defining the studied area</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(prevR, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Registered S3 methods overwritten by 'ggplot2':
##   method         from 
##   [.quosures     rlang
##   c.quosures     rlang
##   print.quosures rlang</code></pre>
<pre><code>## Registered S3 method overwritten by 'xts':
##   method     from
##   as.zoo.xts zoo</code></pre>
<pre><code>## 
## 
## Bienvenue dans 'prevR' : Estimation des tendances régionales d'une prévalence</code></pre>
<pre><code>##  - tapez help('prevR') pour les détails
##  - tapez demo(prevR) pour une démonstration
##  - tapez vignette('prevR-FR') pour la documentation en français
##  - tapez citation('prevR') pour savoir comment citer prevR dans une publication.
## 
## </code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">col &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">id =</span> <span class="st">"cluster"</span>, <span class="dt">x =</span> <span class="st">"x"</span>, <span class="dt">y =</span> <span class="st">"y"</span>, <span class="dt">n =</span> <span class="st">"n"</span>, <span class="dt">pos =</span> <span class="st">"pos"</span>, <span class="dt">c.type =</span> <span class="st">"residence"</span>, <span class="dt">wn =</span> <span class="st">"weighted.n"</span>, <span class="dt">wpos =</span> <span class="st">"weighted.pos"</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">dhs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as.prevR.html">as.prevR</a></span>(fdhs.clusters, col, fdhs.boundary)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(dhs)</a></code></pre></div>
<pre><code>## Formal class 'prevR' [package "prevR"] with 4 slots
##   ..@ clusters:'data.frame': 401 obs. of  10 variables:
##   .. ..$ id    : int [1:401] 1 10 100 101 102 103 104 105 106 107 ...
##   .. ..$ x     : num [1:401] -1.21 -1.79 -2.29 -2.71 -1.96 ...
##   .. ..$ y     : num [1:401] 7.29 6.13 5.96 6.04 5.12 ...
##   .. ..$ n     : num [1:401] 23 22 22 28 21 21 11 24 23 15 ...
##   .. ..$ pos   : num [1:401] 0 0 0 0 3 4 0 1 0 0 ...
##   .. ..$ c.type: Factor w/ 2 levels "Rural","Urban": 1 1 1 1 1 1 1 1 1 1 ...
##   .. ..$ wn    : num [1:401] 19.8 19.8 20.2 20.2 20.2 ...
##   .. ..$ wpos  : num [1:401] 0 0 0 0 2.88 ...
##   .. ..$ prev  : num [1:401] 0 0 0 0 14.3 ...
##   .. ..$ wprev : num [1:401] 0 0 0 0 14.3 ...
##   ..@ boundary:Formal class 'SpatialPolygons' [package "sp"] with 4 slots
##   .. .. ..@ polygons   :List of 1
##   .. .. .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
##   .. .. .. .. .. ..@ Polygons :List of 1
##   .. .. .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
##   .. .. .. .. .. .. .. .. ..@ labpt  : num [1:2] -0.794 10.172
##   .. .. .. .. .. .. .. .. ..@ area   : num 51.9
##   .. .. .. .. .. .. .. .. ..@ hole   : logi FALSE
##   .. .. .. .. .. .. .. .. ..@ ringDir: int 1
##   .. .. .. .. .. .. .. .. ..@ coords : num [1:4056, 1:2] 1.28 1.25 1.23 1.22 1.22 ...
##   .. .. .. .. .. ..@ plotOrder: int 1
##   .. .. .. .. .. ..@ labpt    : num [1:2] -0.794 10.172
##   .. .. .. .. .. ..@ ID       : chr "P1"
##   .. .. .. .. .. ..@ area     : num 51.9
##   .. .. ..@ plotOrder  : int 1
##   .. .. ..@ bbox       : num [1:2, 1:2] -5.52 4.74 3.85 15.08
##   .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. ..$ : chr [1:2] "x" "y"
##   .. .. .. .. ..$ : chr [1:2] "min" "max"
##   .. .. ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slot
##   .. .. .. .. ..@ projargs: chr "+proj=longlat +ellps=WGS84"
##   ..@ proj    :Formal class 'CRS' [package "sp"] with 1 slot
##   .. .. ..@ projargs: chr "+proj=longlat +ellps=WGS84"
##   ..@ rings   : list()</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/print-prevR-method.html">print</a></span>(dhs)</a></code></pre></div>
<pre><code>## Objet de classe 'prevR'</code></pre>
<pre><code>## Nombre de clusters : 401</code></pre>
<pre><code>## Nombre d'observations : 8000</code></pre>
<pre><code>## Nombre de cas positifs : 810</code></pre>
<pre><code>## Le jeu de données est pondéré.</code></pre>
<pre><code>## 
## Prévalence nationale : 10.12%</code></pre>
<pre><code>## Prévalence nationale pondérée : 10.16%</code></pre>
<pre><code>## 
## Projection utilisée : +proj=longlat +ellps=WGS84</code></pre>
<pre><code>## 
## Domaine des cordonnées</code></pre>
<pre><code>##        min     max
## x -5.37750  3.6850
## y  4.80326 14.1225</code></pre>
<pre><code>## 
## Domaine des coordonnées des frontières</code></pre>
<pre><code>##         min       max
## x -5.518916  3.851701
## y  4.736723 15.082593</code></pre>
<p>An interactive helper function <code><a href="../reference/import.dhs.html">import.dhs()</a></code> could be used to compute statistics per cluster and to generate the <strong>prevR</strong> object for those who downloaded individual files (SPSS format) and location of clusters (dbf format) from DHS website (<a href="https://dhsprogram.com/" class="uri">https://dhsprogram.com/</a>).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">imported_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/import.dhs.html">import.dhs</a></span>(<span class="st">"data.sav"</span>, <span class="st">"gps.dbf"</span>)</a></code></pre></div>
<p>Boudaries of a specific country could be obtained with <code><a href="../reference/create.boundary.html">create.boundary()</a></code>.</p>
</div>
<div id="plotting-a-prevr-object" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-a-prevr-object" class="anchor"></a>Plotting a prevR object</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(dhs, <span class="dt">main =</span> <span class="st">"Clusters position"</span>)</a></code></pre></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(dhs, <span class="dt">type =</span> <span class="st">"c.type"</span>, <span class="dt">main =</span> <span class="st">"Clusters by residence"</span>)</a></code></pre></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-4-2.png" width="576"></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(dhs, <span class="dt">type =</span> <span class="st">"count"</span>, <span class="dt">main =</span> <span class="st">"Observations by cluster"</span>)</a></code></pre></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-4-3.png" width="576"></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(dhs, <span class="dt">type =</span> <span class="st">"flower"</span>, <span class="dt">main =</span> <span class="st">"Positive cases by cluster"</span>)</a></code></pre></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-4-4.png" width="576"></p>
</div>
<div id="changing-coordinates-projection" class="section level2">
<h2 class="hasAnchor">
<a href="#changing-coordinates-projection" class="anchor"></a>Changing coordinates projection</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(dhs, <span class="dt">axes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">dhs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/changeproj-prevR-method.html">changeproj</a></span>(dhs, <span class="st">"+proj=utm +zone=30 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"</span>)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw"><a href="../reference/print-prevR-method.html">print</a></span>(dhs)</a></code></pre></div>
<pre><code>## Objet de classe 'prevR'</code></pre>
<pre><code>## Nombre de clusters : 401</code></pre>
<pre><code>## Nombre d'observations : 8000</code></pre>
<pre><code>## Nombre de cas positifs : 810</code></pre>
<pre><code>## Le jeu de données est pondéré.</code></pre>
<pre><code>## 
## Prévalence nationale : 10.12%</code></pre>
<pre><code>## Prévalence nationale pondérée : 10.16%</code></pre>
<pre><code>## 
## Projection utilisée : +proj=utm +zone=30 +ellps=WGS84 +datum=WGS84 +units=m +no_defs +towgs84=0,0,0</code></pre>
<pre><code>## 
## Domaine des cordonnées</code></pre>
<pre><code>##        min     max
## x 240094.2 1231995
## y 531003.3 1562155</code></pre>
<pre><code>## 
## Domaine des coordonnées des frontières</code></pre>
<pre><code>##        min     max
## x 224228.1 1251165
## y 523628.1 1669034</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(dhs, <span class="dt">axes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-5-2.png" width="576"></p>
</div>
<div id="quick-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-analysis" class="anchor"></a>Quick analysis</h2>
<p>Function <code><a href="../reference/quick.prevR.html">quick.prevR()</a></code> allows to perform a quick analysis:</p>
<ul>
<li>an optimal value of <strong>N</strong> will be computed with <code><a href="../reference/Noptim.html">Noptim()</a></code>
</li>
<li>adapative bandwiths will be calculted with <code><a href="../reference/rings-prevR-method.html">rings()</a></code>
</li>
<li>a prevalence surface will be computed with <code><a href="../reference/kde-prevR-method.html">kde()</a></code>
</li>
<li>the surface of rings radii will be generated with <code><a href="../reference/krige-ANY-prevR-method.html">krige()</a></code>
</li>
<li>a <strong>ggplot2</strong> of the prevalence surface will be generated and rings radii will be added as a contour plot</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw"><a href="../reference/quick.prevR.html">quick.prevR</a></span>(fdhs)</a></code></pre></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>Several values of <strong>N</strong> could be specified, and several options allows you to return detailed results.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/quick.prevR.html">quick.prevR</a></span>(fdhs, <span class="dt">N =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>), <span class="dt">return.results =</span> <span class="ot">TRUE</span>, <span class="dt">return.plot =</span> <span class="ot">TRUE</span>, <span class="dt">plot.results =</span> <span class="ot">FALSE</span>, <span class="dt">progression =</span> <span class="ot">FALSE</span>, <span class="dt">nb.cells =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb42-2" data-line-number="2">res<span class="op">$</span>plot</a></code></pre></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
</div>
<div id="step-by-step-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#step-by-step-analysis" class="anchor"></a>Step by step analysis</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co"># Calculating rings of the same number of observations for different values of N</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2">dhs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rings-prevR-method.html">rings</a></span>(fdhs, <span class="dt">N =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">500</span>), <span class="dt">progression =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="kw"><a href="../reference/print-prevR-method.html">print</a></span>(dhs)</a></code></pre></div>
<pre><code>## Objet de classe 'prevR'</code></pre>
<pre><code>## Nombre de clusters : 401</code></pre>
<pre><code>## Nombre d'observations : 8000</code></pre>
<pre><code>## Nombre de cas positifs : 810</code></pre>
<pre><code>## Le jeu de données est pondéré.</code></pre>
<pre><code>## 
## Prévalence nationale : 10.12%</code></pre>
<pre><code>## Prévalence nationale pondérée : 10.16%</code></pre>
<pre><code>## 
## Projection utilisée :  +proj=longlat +ellps=WGS84</code></pre>
<pre><code>## 
## Domaine des cordonnées</code></pre>
<pre><code>##        min     max
## x -5.37750  3.6850
## y  4.80326 14.1225</code></pre>
<pre><code>## 
## Domaine des coordonnées des frontières</code></pre>
<pre><code>##         min       max
## x -5.518916  3.851701
## y  4.736723 15.082593</code></pre>
<pre><code>## 
## Couples (N,R) disponibles dans le slot 'rings' :</code></pre>
<pre><code>##    N   R
##  100 Inf
##  200 Inf
##  300 Inf
##  400 Inf
##  500 Inf</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw"><a href="../reference/summary-prevR-method.html">summary</a></span>(dhs)</a></code></pre></div>
<pre><code>## Objet de classe 'prevR'</code></pre>
<pre><code>## SLOT CLUSTERS</code></pre>
<pre><code>##        x                 y                n              pos      
##  Min.   :-5.3775   Min.   : 4.803   Min.   : 8.00   Min.   :0.00  
##  1st Qu.:-1.7925   1st Qu.: 6.375   1st Qu.:17.00   1st Qu.:0.00  
##  Median :-0.7650   Median : 7.455   Median :20.00   Median :2.00  
##  Mean   :-0.6605   Mean   : 8.647   Mean   :19.95   Mean   :2.02  
##  3rd Qu.: 0.1590   3rd Qu.:11.205   3rd Qu.:23.00   3rd Qu.:3.00  
##  Max.   : 3.6850   Max.   :14.123   Max.   :31.00   Max.   :9.00  
##    c.type          wn             wpos            prev       
##  Rural:230   Min.   :18.58   Min.   :0.000   Min.   : 0.000  
##  Urban:171   1st Qu.:19.84   1st Qu.:0.000   1st Qu.: 0.000  
##              Median :20.04   Median :1.544   Median : 7.692  
##              Mean   :19.95   Mean   :2.027   Mean   :10.143  
##              3rd Qu.:20.12   3rd Qu.:3.166   3rd Qu.:15.789  
##              Max.   :21.76   Max.   :8.806   Max.   :43.750  
##      wprev       
##  Min.   : 0.000  
##  1st Qu.: 0.000  
##  Median : 7.692  
##  Mean   :10.143  
##  3rd Qu.:15.789  
##  Max.   :43.750</code></pre>
<pre><code>## 
## SLOT RINGS POUR N=100 ET R=Inf</code></pre>
<pre><code>##      r.pos            r.n            r.prev          r.radius      
##  Min.   : 0.00   Min.   :100.0   Min.   : 0.000   Min.   :  4.155  
##  1st Qu.: 4.00   1st Qu.:105.0   1st Qu.: 4.000   1st Qu.: 23.046  
##  Median :11.00   Median :110.0   Median : 9.483   Median : 37.853  
##  Mean   :11.63   Mean   :110.7   Mean   :10.550   Mean   : 42.219  
##  3rd Qu.:18.00   3rd Qu.:115.0   3rd Qu.:15.789   3rd Qu.: 57.861  
##  Max.   :32.00   Max.   :127.0   Max.   :27.586   Max.   :142.042  
##    r.clusters        r.wpos            r.wn           r.wprev      
##  Min.   :4.000   Min.   : 0.000   Min.   : 79.76   Min.   : 0.000  
##  1st Qu.:5.000   1st Qu.: 4.515   1st Qu.:100.25   1st Qu.: 3.895  
##  Median :6.000   Median :11.175   Median :118.70   Median : 9.551  
##  Mean   :5.591   Mean   :11.792   Mean   :111.52   Mean   :10.684  
##  3rd Qu.:6.000   3rd Qu.:17.256   3rd Qu.:120.13   3rd Qu.:15.735  
##  Max.   :7.000   Max.   :33.937   Max.   :140.88   Max.   :28.210</code></pre>
<pre><code>## 
## SLOT RINGS POUR N=200 ET R=Inf</code></pre>
<pre><code>##      r.pos            r.n            r.prev           r.radius      
##  Min.   : 2.00   Min.   :200.0   Min.   : 0.8929   Min.   :  7.171  
##  1st Qu.: 9.00   1st Qu.:206.0   1st Qu.: 4.3902   1st Qu.: 37.579  
##  Median :22.00   Median :211.0   Median :10.2804   Median : 58.657  
##  Mean   :22.55   Mean   :210.8   Mean   :10.7053   Mean   : 64.005  
##  3rd Qu.:33.00   3rd Qu.:216.0   3rd Qu.:15.4229   3rd Qu.: 89.381  
##  Max.   :56.00   Max.   :226.0   Max.   :26.2136   Max.   :231.980  
##    r.clusters        r.wpos           r.wn          r.wprev      
##  Min.   : 9.00   Min.   : 2.47   Min.   :175.0   Min.   : 1.030  
##  1st Qu.:10.00   1st Qu.:10.50   1st Qu.:199.8   1st Qu.: 4.563  
##  Median :11.00   Median :22.30   Median :217.3   Median :10.485  
##  Mean   :10.53   Mean   :22.66   Mean   :210.0   Mean   :10.824  
##  3rd Qu.:11.00   3rd Qu.:31.98   3rd Qu.:220.0   3rd Qu.:15.797  
##  Max.   :12.00   Max.   :53.47   Max.   :241.0   Max.   :26.666</code></pre>
<pre><code>## 
## SLOT RINGS POUR N=300 ET R=Inf</code></pre>
<pre><code>##      r.pos            r.n            r.prev          r.radius      
##  Min.   : 5.00   Min.   :300.0   Min.   : 1.587   Min.   :  9.971  
##  1st Qu.:15.00   1st Qu.:304.0   1st Qu.: 4.983   1st Qu.: 45.750  
##  Median :32.00   Median :310.0   Median :10.559   Median : 73.931  
##  Mean   :33.37   Mean   :309.8   Mean   :10.764   Mean   : 79.767  
##  3rd Qu.:47.00   3rd Qu.:315.0   3rd Qu.:15.142   3rd Qu.:108.783  
##  Max.   :78.00   Max.   :327.0   Max.   :24.759   Max.   :268.172  
##    r.clusters        r.wpos            r.wn          r.wprev      
##  Min.   :13.00   Min.   : 4.284   Min.   :260.6   Min.   : 1.532  
##  1st Qu.:15.00   1st Qu.:15.937   1st Qu.:299.2   1st Qu.: 5.080  
##  Median :15.00   Median :33.525   Median :301.8   Median :10.319  
##  Mean   :15.44   Mean   :33.297   Mean   :307.9   Mean   :10.853  
##  3rd Qu.:16.00   3rd Qu.:46.856   3rd Qu.:320.0   3rd Qu.:15.429  
##  Max.   :17.00   Max.   :76.990   Max.   :341.4   Max.   :25.273</code></pre>
<pre><code>## 
## SLOT RINGS POUR N=400 ET R=Inf</code></pre>
<pre><code>##      r.pos            r.n            r.prev          r.radius     
##  Min.   : 8.00   Min.   :400.0   Min.   : 2.000   Min.   : 12.70  
##  1st Qu.:22.00   1st Qu.:405.0   1st Qu.: 5.327   1st Qu.: 54.42  
##  Median :44.00   Median :410.0   Median :10.602   Median : 85.41  
##  Mean   :44.18   Mean   :410.3   Mean   :10.764   Mean   : 94.79  
##  3rd Qu.:58.00   3rd Qu.:415.0   3rd Qu.:14.217   3rd Qu.:127.73  
##  Max.   :98.00   Max.   :427.0   Max.   :23.278   Max.   :293.64  
##    r.clusters        r.wpos            r.wn          r.wprev      
##  Min.   :18.00   Min.   : 8.229   Min.   :360.1   Min.   : 2.045  
##  1st Qu.:20.00   1st Qu.:22.358   1st Qu.:399.9   1st Qu.: 5.345  
##  Median :21.00   Median :43.851   Median :415.4   Median :10.315  
##  Mean   :20.54   Mean   :44.298   Mean   :409.6   Mean   :10.851  
##  3rd Qu.:21.00   3rd Qu.:58.963   3rd Qu.:421.0   3rd Qu.:14.341  
##  Max.   :22.00   Max.   :95.591   Max.   :443.4   Max.   :23.452</code></pre>
<pre><code>## 
## SLOT RINGS POUR N=500 ET R=Inf</code></pre>
<pre><code>##      r.pos             r.n            r.prev          r.radius     
##  Min.   : 14.00   Min.   :500.0   Min.   : 2.783   Min.   : 16.38  
##  1st Qu.: 31.00   1st Qu.:505.0   1st Qu.: 6.163   1st Qu.: 67.01  
##  Median : 54.00   Median :510.0   Median :10.700   Median : 98.47  
##  Mean   : 55.24   Mean   :510.3   Mean   :10.811   Mean   :107.68  
##  3rd Qu.: 70.00   3rd Qu.:515.0   3rd Qu.:13.699   3rd Qu.:140.71  
##  Max.   :116.00   Max.   :528.0   Max.   :22.612   Max.   :347.09  
##    r.clusters        r.wpos            r.wn          r.wprev      
##  Min.   :23.00   Min.   : 12.93   Min.   :455.7   Min.   : 2.499  
##  1st Qu.:25.00   1st Qu.: 31.71   1st Qu.:499.5   1st Qu.: 6.138  
##  Median :26.00   Median : 51.91   Median :510.9   Median :10.222  
##  Mean   :25.53   Mean   : 55.12   Mean   :509.3   Mean   :10.869  
##  3rd Qu.:26.00   3rd Qu.: 70.17   3rd Qu.:520.8   3rd Qu.:13.929  
##  Max.   :28.00   Max.   :110.78   Max.   :555.8   Max.   :22.822</code></pre>
<pre><code>## 
## QUANTILES DE r.radius (en kilomètres) :</code></pre>
<pre><code>##              0%   10%   25%   50%    75%    80%    90%    95%    99%
## N100.RInf  4.15  7.84 23.05 37.85  57.86  62.99  79.63  93.12 121.77
## N200.RInf  7.17 14.58 37.58 58.66  89.38  94.40 114.97 134.81 173.37
## N300.RInf  9.97 18.75 45.75 73.93 108.78 114.65 138.17 159.10 211.31
## N400.RInf 12.70 31.42 54.42 85.41 127.73 136.67 163.91 177.11 241.44
## N500.RInf 16.38 41.15 67.01 98.47 140.71 156.53 181.92 201.87 286.18
##             100%
## N100.RInf 142.04
## N200.RInf 231.98
## N300.RInf 268.17
## N400.RInf 293.64
## N500.RInf 347.09</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="co"># Prevalence surface for N=300</span></a>
<a class="sourceLine" id="cb74-2" data-line-number="2">prev.N300 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/kde-prevR-method.html">kde</a></span>(dhs, <span class="dt">N =</span> <span class="dv">300</span>, <span class="dt">nb.cells =</span> <span class="dv">200</span>, <span class="dt">progression =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb74-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sp)</a>
<a class="sourceLine" id="cb74-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/sp/topics/spplot">spplot</a></span>(prev.N300, <span class="st">"k.wprev.N300.RInf"</span>, <span class="dt">cuts =</span> <span class="dv">100</span>, <span class="dt">col.regions =</span> <span class="kw"><a href="../reference/prevR.colors.html">prevR.colors.red</a></span>(<span class="dv">101</span>), <span class="dt">main =</span> <span class="st">"Regional trends of prevalence (N=300)"</span>)</a></code></pre></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="co"># Surface of rings' radius</span></a>
<a class="sourceLine" id="cb75-2" data-line-number="2">radius.N300 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/krige-ANY-prevR-method.html">krige</a></span>(<span class="st">"r.radius"</span>, dhs, <span class="dt">N =</span> <span class="dv">300</span>, <span class="dt">nb.cells =</span> <span class="dv">200</span>)</a></code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/sp/topics/spplot">spplot</a></span>(radius.N300, <span class="dt">cuts =</span> <span class="dv">100</span>, <span class="dt">col.regions =</span> <span class="kw"><a href="../reference/prevR.colors.html">prevR.colors.blue</a></span>(<span class="dv">101</span>), <span class="dt">main =</span> <span class="st">"Radius of circle (N=300)"</span>)</a></code></pre></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-10-2.png" width="576"></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="co"># ggplot2 graph</span></a>
<a class="sourceLine" id="cb78-2" data-line-number="2">res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as.data.frame.prevR.html">as.data.frame</a></span>(prev.N300)</a>
<a class="sourceLine" id="cb78-3" data-line-number="3">res &lt;-<span class="st"> </span>res[<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(res<span class="op">$</span>k.wprev.N300.RInf), ]</a>
<a class="sourceLine" id="cb78-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb78-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="dt">data =</span> res) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> k.wprev.N300.RInf) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_tile">geom_raster</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb78-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_gradient">scale_fill_gradientn</a></span>(<span class="dt">colours=</span><span class="kw"><a href="../reference/prevR.colors.html">prevR.colors.red</a></span>(<span class="dv">20</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/coord_fixed">coord_fixed</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb78-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="../reference/theme_prevR.html">theme_prevR_light</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb78-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">fill =</span> <span class="st">"Prevalence (%)"</span>)</a></code></pre></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-10-3.png" width="576"></p>
</div>
<div id="functions-and-methods-provided-by-prevr" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-and-methods-provided-by-prevr" class="anchor"></a>Functions and methods provided by prevR</h2>
<p>The content of <strong>prevR</strong> can be broken up as follows:</p>
<div id="datasets" class="section level3">
<h3 class="hasAnchor">
<a href="#datasets" class="anchor"></a>Datasets</h3>
<ul>
<li>
<code>fdhs</code> is a fictive dataset used for testing the package.</li>
<li>
<code>TMWorldBorders</code> provides national borders of every countries in the World and could be used to define the limits of the studied area.</li>
</ul>
</div>
<div id="creating-objects" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-objects" class="anchor"></a>Creating objects</h3>
<p>prevR functions takes as input ojects of class prevR.</p>
<ul>
<li>
<code><a href="../reference/import.dhs.html">import.dhs()</a></code> allows to import easily, through a step by step procedure, data from a DHS (Demographic and Health Surveys) downloaded from <a href="http://www.measuredhs.com" class="uri">http://www.measuredhs.com</a>.</li>
<li>
<code><a href="../reference/as.prevR.html">as.prevR()</a></code> is a generic function to create an object of class prevR.</li>
<li>
<code><a href="../reference/create.boundary.html">create.boundary()</a></code> could be used to select borders of a country and transfer them to as.prevR in order to define the studied area.</li>
</ul>
</div>
<div id="data-visualisation" class="section level3">
<h3 class="hasAnchor">
<a href="#data-visualisation" class="anchor"></a>Data visualisation</h3>
<ul>
<li>Methods <code><a href="../reference/show-prevR-method.html">show()</a></code>, <code><a href="../reference/print-prevR-method.html">print()</a></code> and <code><a href="../reference/summary-prevR-method.html">summary()</a></code> display a summary of a object of class prevR.</li>
<li>The method <code><a href="../reference/plot-prevR-missing-method.html">plot()</a></code> could be used on a object of class prevR for visualising the studied area, spatial position of clusters, number of observations or number of positive cases by cluster.</li>
</ul>
</div>
<div id="data-manipulation" class="section level3">
<h3 class="hasAnchor">
<a href="#data-manipulation" class="anchor"></a>Data manipulation</h3>
<ul>
<li>The method <code><a href="../reference/changeproj-prevR-method.html">changeproj()</a></code> changes the projection of the spatial coordinates.</li>
<li>The method <code><a href="../reference/as.data.frame.prevR.html">as.data.frame()</a></code> converts an object of class prevR into a data frame.</li>
<li>The method <code><a href="../reference/export-prevR-method.html">export()</a></code> export data and/or the studied area in a text file, a dbf file or a shapefile.</li>
</ul>
</div>
<div id="data-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#data-analysis" class="anchor"></a>Data analysis</h3>
<ul>
<li>
<code><a href="../reference/rings-prevR-method.html">rings()</a></code> calculates rings of equal number of observations and/or equal radius.</li>
<li>
<code><a href="../reference/kde-prevR-method.html">kde()</a></code> calculates a prevalence surface or a relative risks surface using gaussian kernel density estimators (kde) with adaptative bandwiths.</li>
<li>
<code><a href="../reference/krige-ANY-prevR-method.html">krige()</a></code> executes a spatial interpolation using an ordinary kriging.</li>
<li>
<code><a href="../reference/krige-ANY-prevR-method.html">idw()</a></code> executes a spatial interpolation using an inverse distance weighting (idw) technique.</li>
</ul>
</div>
<div id="results-visualisation-and-export" class="section level3">
<h3 class="hasAnchor">
<a href="#results-visualisation-and-export" class="anchor"></a>Results visualisation and export</h3>
<ul>
<li>Outputs of <code><a href="../reference/kde-prevR-method.html">kde()</a></code>, <code><a href="../reference/krige-ANY-prevR-method.html">krige()</a></code> and <code><a href="../reference/krige-ANY-prevR-method.html">idw()</a></code> are objects of class <code>SpatialPixelsDataFrame</code> (<strong>sp</strong> package).</li>
<li>Results could be plotted using the function <code><a href="https://www.rdocumentation.org/packages/sp/topics/spplot">spplot()</a></code> from <strong>sp</strong>.</li>
<li>prevR provides several continuous color palettes (see <code>prevR.colors</code>) compatible with <code><a href="https://www.rdocumentation.org/packages/sp/topics/spplot">spplot()</a></code>.</li>
<li>Calculated surfaces could be export using the function <code>writeAsciiGrid()</code> from <strong>maptools</strong>.</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#importing-data">Importing data</a></li>
      <li><a href="#plotting-a-prevr-object">Plotting a prevR object</a></li>
      <li><a href="#changing-coordinates-projection">Changing coordinates projection</a></li>
      <li><a href="#quick-analysis">Quick analysis</a></li>
      <li><a href="#step-by-step-analysis">Step by step analysis</a></li>
      <li><a href="#functions-and-methods-provided-by-prevr">Functions and methods provided by prevR</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joseph Larmarange.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
