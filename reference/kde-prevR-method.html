<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Kernel density estimation for prevR object. — kde,prevR-method • prevR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Kernel density estimation for prevR object. — kde,prevR-method"><meta property="og:description" content="This function allows to calculate a prevalence surface (ratio of two intensity surfaces)
and/or a relative risks surface (ratio of two density surfaces) using gaussian kernel estimators
with adaptative bandwidths of equal number of observations or equal radius."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prevR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/intro_prevR.html">Introduction to prevR</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/larmarange/prevR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Kernel density estimation for prevR object.</h1>
    <small class="dont-index">Source: <a href="https://github.com/larmarange/prevR/blob/HEAD/R/kde.prevR.r" class="external-link"><code>R/kde.prevR.r</code></a></small>
    <div class="hidden name"><code>kde-prevR-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows to calculate a prevalence surface (ratio of two intensity surfaces)
and/or a relative risks surface (ratio of two density surfaces) using gaussian kernel estimators
with adaptative bandwidths of equal number of observations or equal radius.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S4 method for prevR</span>
<span class="fu">kde</span><span class="op">(</span>
  <span class="va">object</span>,
  N <span class="op">=</span> <span class="cn">NULL</span>,
  R <span class="op">=</span> <span class="cn">NULL</span>,
  weighted <span class="op">=</span> <span class="cn">TRUE</span>,
  risk.ratio <span class="op">=</span> <span class="cn">FALSE</span>,
  keep.details <span class="op">=</span> <span class="cn">FALSE</span>,
  nb.cells <span class="op">=</span> <span class="fl">100</span>,
  cell.size <span class="op">=</span> <span class="cn">NULL</span>,
  progression <span class="op">=</span> <span class="cn">TRUE</span>,
  short.names <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>object of class <a href="prevR-class.html">prevR</a>.</p></dd>
<dt>N</dt>
<dd><p>integer or list of integers corresponding to the rings to use.</p></dd>
<dt>R</dt>
<dd><p>integer or list of integers corresponding to the rings to use.</p></dd>
<dt>weighted</dt>
<dd><p>use weighted data (TRUE, FALSE or "2")?</p></dd>
<dt>risk.ratio</dt>
<dd><p>calculate a relative risks surface instead of a prevalence surface (TRUE, FALSE or "2")?</p></dd>
<dt>keep.details</dt>
<dd><p>return surface of positive cases and surface of observed cases?</p></dd>
<dt>nb.cells</dt>
<dd><p>number of cells on the longest side of the studied area
(unused if <code>cell.size</code> is defined).</p></dd>
<dt>cell.size</dt>
<dd><p>size of each cell (in the unit of the projection).</p></dd>
<dt>progression</dt>
<dd><p>show a progress bar?</p></dd>
<dt>short.names</dt>
<dd><p>should names of the output be short?</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Object of class <a href="https://rdrr.io/pkg/sp/man/SpatialPixelsDataFrame-class.html" class="external-link">sp::SpatialPixelsDataFrame</a>.
Surfaces are named according to the name of the corresponding variable, N and R
(for example: <em>k.prev.N300.RInf</em>). If <code>short.names</code> is <code>TRUE</code> and if there is
only one combination of couples (N, R), variable names will not be suffixed by the value of
N and R.
Estimated variables are (depending on the function parameters) :</p><ul><li><p>"k.pos" unweighted intensity surface of positive cases.</p></li>
<li><p>"k.obs" unweighted intensity surface of observed cases.</p></li>
<li><p>"k.prev" unweighted surface of prevalence (k.pos/k.obs).</p></li>
<li><p>"k.case" unweighted density surface of positive cases.</p></li>
<li><p>"k.control" unweighted density surface of observed cases.</p></li>
<li><p>"k.rr" unweighted surface of relative risks (k.case/k.control).</p></li>
<li><p>"k.wpos" weighted intensity surface of positive cases.</p></li>
<li><p>"k.wobs" weighted intensity surface of observed cases.</p></li>
<li><p>"k.wprev" weighted surface of prevalence (k.wpos/k.wobs).</p></li>
<li><p>"k.wcase" weighted density surface of positive cases.</p></li>
<li><p>"k.wcontrol" weighted density surface of observed cases.</p></li>
<li><p>"k.wrr" weighted surface of relative risks (k.wcase/k.wcontrol).</p></li>
</ul><p><code>NA</code> value is applied to cells of the grid located outside of the studied area<br>(see <code><a href="NA.outside.SpatialPolygons.html">NA.outside.SpatialPolygons()</a></code>).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function calculates a prevalence surface as the ratio of the intensity surface
(expressed in cases per surface unit) of positive cases on the intensity surface of observed cases
and could also calculate a relative risks surface corresponding to the ratio of the density surface
(whose integral has been normalized to one) of positive cases on density surface of observed cases.</p>
<p>This method is a variant of the nearest neighbor technique. Surfaces are estimated using gaussian
kernel estimators with adaptative bandwidths, bandwidth size being determined by a minimum number of
observations in the neighborhood (see <code><a href="rings-prevR-method.html">rings()</a></code> for more details).
Fixed bandwidths could also be used. More precisely, the bandwidth used is half the radius of rings of
equal number of observations or equal radius (parameters <code>N</code> and <code>R</code>) calculated by the
function <code><a href="rings-prevR-method.html">rings()</a></code>.<br>
See references for a detailed explanation of the implemented methodology.</p>
<p><code>N</code> and <code>R</code> determine the rings to use for the estimation. If they are not defined,
surfaces will be estimated for each available couples (N,R). Several estimations could be
simultaneously calculated if several values of N and R are defined.</p>
<p>A suggested value of N could be computed with <code><a href="Noptim.html">Noptim()</a></code>.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Results could be plotted with <code><a href="https://rdrr.io/pkg/sp/man/spplot.html" class="external-link">sp::spplot()</a></code>.<br><span class="pkg">prevR</span> provides several continuous color palettes (see <a href="prevR.colors.html">prevR.colors</a>)
compatible with <code><a href="https://rdrr.io/pkg/sp/man/spplot.html" class="external-link">sp::spplot()</a></code>.<br>
Calculated surfaces could be export using the function
<code><a href="http://maptools.r-forge.r-project.org/reference/asciigrid.html" class="external-link">maptools::writeAsciiGrid()</a></code>.</p>
<p>See the package <span class="pkg">sparr</span> for another methodology to estimate relative
risks surfaces, adapted for other kind of data than Demographic and Health Surveys (DHS).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Larmarange Joseph, Vallo Roselyne, Yaro Seydou, Msellati Philippe and Meda Nicolas (2011)
"Methods for mapping regional trends of HIV prevalence from Demographic and Health Surveys (DHS)",
<em>Cybergeo: European Journal of Geography</em>, no 558, <a href="https://journals.openedition.org/cybergeo/24606" class="external-link">https://journals.openedition.org/cybergeo/24606</a>,
DOI: 10.4000/cybergeo.24606.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/KernSmooth/man/bkde2D.html" class="external-link">KernSmooth::bkde2D()</a></code>, <code><a href="rings-prevR-method.html">rings()</a></code>, <code><a href="Noptim.html">Noptim()</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="va">dhs</span> <span class="op">&lt;-</span> <span class="fu"><a href="rings-prevR-method.html">rings</a></span><span class="op">(</span><span class="va">fdhs</span>, N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">200</span>,<span class="fl">300</span>,<span class="fl">400</span>,<span class="fl">500</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="va">prev.N300</span> <span class="op">&lt;-</span> <span class="fu">kde</span><span class="op">(</span><span class="va">dhs</span>, N<span class="op">=</span><span class="fl">300</span>, nb.cells<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/pkg/sp/man/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">prev.N300</span>, <span class="st">'k.wprev.N300.RInf'</span>,</span>
<span class="r-in">         cuts<span class="op">=</span><span class="fl">100</span>, col.regions<span class="op">=</span><span class="fu"><a href="prevR.colors.html">prevR.colors.red</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span>,</span>
<span class="r-in">         main<span class="op">=</span><span class="st">"Regional trends of prevalence (N=300)"</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="va">prev.krige</span> <span class="op">&lt;-</span> <span class="fu">kde</span><span class="op">(</span><span class="va">dhs</span>, N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">300</span>,<span class="fl">500</span><span class="op">)</span>, R<span class="op">=</span><span class="cn">Inf</span>,</span>
<span class="r-in">                    nb.cells<span class="op">=</span><span class="fl">200</span>, risk.ratio<span class="op">=</span><span class="fl">2</span>, keep.details<span class="op">=</span><span class="cn">FALSE</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">prev.krige</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/pkg/sp/man/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">prev.krige</span>,</span>
<span class="r-in">         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'k.wprev.N100.RInf'</span>,<span class="st">'k.wprev.N300.RInf'</span>,<span class="st">'k.wprev.N500.RInf'</span><span class="op">)</span>,</span>
<span class="r-in">         cuts<span class="op">=</span><span class="fl">100</span>, col.regions<span class="op">=</span><span class="fu"><a href="prevR.colors.html">prevR.colors.red</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joseph Larmarange.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

