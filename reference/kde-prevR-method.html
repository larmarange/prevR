<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Kernel density estimation for prevR object. — kde,prevR-method • prevR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Kernel density estimation for prevR object. — kde,prevR-method" />
<meta property="og:description" content="This function allows to calculate a prevalence surface (ratio of two intensity surfaces)
and/or a relative risks surface (ratio of two density surfaces) using gaussian kernel estimators
with adaptative bandwiths of equal number of observations or equal radius." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prevR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/intro_prevR.html">Introduction to prevR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/larmarange/prevR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Kernel density estimation for prevR object.</h1>
    <small class="dont-index">Source: <a href='https://github.com/larmarange/prevR/blob/master/R/kde.prevR.r'><code>R/kde.prevR.r</code></a></small>
    <div class="hidden name"><code>kde-prevR-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows to calculate a prevalence surface (ratio of two intensity surfaces)
and/or a relative risks surface (ratio of two density surfaces) using gaussian kernel estimators
with adaptative bandwiths of equal number of observations or equal radius.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for prevR</span>
<span class='fu'>kde</span>(
  <span class='no'>object</span>,
  <span class='kw'>N</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>R</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>weighted</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>risk.ratio</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>keep.details</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>nb.cells</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>cell.size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>progression</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>short.names</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>object of class <a href='prevR-class.html'>prevR</a>.</p></td>
    </tr>
    <tr>
      <th>N</th>
      <td><p>integer or list of integers corresponding to the rings to use.</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>integer or list of integers corresponding to the rings to use.</p></td>
    </tr>
    <tr>
      <th>weighted</th>
      <td><p>use weighted data (TRUE, FALSE or "2")?</p></td>
    </tr>
    <tr>
      <th>risk.ratio</th>
      <td><p>calculate a relative risks surface instead of a prevalence surface (TRUE, FALSE or "2")?</p></td>
    </tr>
    <tr>
      <th>keep.details</th>
      <td><p>return surface of positive cases and surface of observed cases?</p></td>
    </tr>
    <tr>
      <th>nb.cells</th>
      <td><p>number of cells on the longuest side of the studied area
(unused if <code>cell.size</code> is defined).</p></td>
    </tr>
    <tr>
      <th>cell.size</th>
      <td><p>size of each cell (in the unit of the projection).</p></td>
    </tr>
    <tr>
      <th>progression</th>
      <td><p>show a progress bar?</p></td>
    </tr>
    <tr>
      <th>short.names</th>
      <td><p>should names of the output be short?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Object of class <a href='https://rdrr.io/pkg/sp/man/SpatialPixelsDataFrame-class.html'>sp::SpatialPixelsDataFrame</a>.
Surfaces are named according to the name of the corresponding variable, N and R
(for example: <em>k.prev.N300.RInf</em>). If <code>short.names</code> is <code>TRUE</code> and if there is
only one combination of couples (N, R), variable names will not be suffixed by the value of
N and R.</p>
<p>Estimated variables are (depending on the function parameters) :</p><ul>
<li><p>"k.pos" unweighted intensity surface of positive cases.</p></li>
<li><p>"k.obs" unweighted intensity surface of observed cases.</p></li>
<li><p>"k.prev" unweighted surface of prevalence (k.pos/k.obs).</p></li>
<li><p>"k.case" unweighted density surface of positive cases.</p></li>
<li><p>"k.control" unweighted density surface of observed cases.</p></li>
<li><p>"k.rr" unweighted surface of relative risks (k.case/k.control).</p></li>
<li><p>"k.wpos" weighted intensity surface of positive cases.</p></li>
<li><p>"k.wobs" weighted intensity surface of observed cases.</p></li>
<li><p>"k.wprev" weighted surface of prevalence (k.wpos/k.wobs).</p></li>
<li><p>"k.wcase" weighted density surface of positive cases.</p></li>
<li><p>"k.wcontrol" weighted density surface of observed cases.</p></li>
<li><p>"k.wrr" weighted surface of relative risks (k.wcase/k.wcontrol).</p></li>
</ul><p><code>NA</code> value is applied to cells of the grid located outside of the studied area<br />
(see <code><a href='NA.outside.SpatialPolygons.html'>NA.outside.SpatialPolygons()</a></code>).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function calculates a prevalence surface as the ratio of the intensity surface
(expressed in cases per surface unit) of positive cases on the intensity surface of observed cases
and could also calculate a relative risks surface corresponding to the ratio of the density surface
(whose integral has been normalized to one) of positive cas on density surface of observed cases.</p>
<p>This method is a variant of the nearest neighbour technique. Surfaces are estimated using gaussian
kernel estimators with adaptative bandwiths, bandwith size being determined by a minimum number of
observations in the neighbourhood (see <code><a href='rings-prevR-method.html'>rings()</a></code> for more details).
Fixed bandwiths could also be used. More precisely, the bandwith used is half the radius of rings of
equal number of observations or equal radius (parameters <code>N</code> and <code>R</code>) calculated by the
function <code><a href='rings-prevR-method.html'>rings()</a></code>.<br />
See referenes for a detailed explanation of the implemented methodology.</p>
<p><code>N</code> and <code>R</code> determine the rings to use for the estimation. If they are not defined,
surfaces will be estimated for each available couples (N,R). Several estimations could be
simultaneously calculated if several values of N and R are defined.</p>
<p>A suggested value of N could be computed with <code><a href='Noptim.html'>Noptim()</a></code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Results could be plotted with <code><a href='https://rdrr.io/pkg/sp/man/spplot.html'>sp::spplot()</a></code>.<br />
<span class="pkg">prevR</span> provides several continuous color palettes (see <a href='prevR.colors.html'>prevR.colors</a>)
compatible with <code><a href='https://rdrr.io/pkg/sp/man/spplot.html'>sp::spplot()</a></code>.<br />
Calculated surfaces could be export using the function
<code><a href='https://rdrr.io/pkg/maptools/man/asciigrid.html'>maptools::writeAsciiGrid()</a></code>.</p>
<p>See the package <span class="pkg">sparr</span> for another methodology to estimate relative
risks surfaces, adapted for other kind of data than Demographic and Helath Surveys (DHS).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Larmarange Joseph, Vallo Roselyne, Yaro Seydou, Msellati Philippe and Meda Nicolas (2011)
"Methods for mapping regional trends of HIV prevalence from Demographic and Health Surveys (DHS)",
<em>Cybergeo: European Journal of Geography</em>, no 558, <a href='https://journals.openedition.org/cybergeo/24606'>https://journals.openedition.org/cybergeo/24606</a>,
DOI: 10.4000/cybergeo.24606.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/GenKern/man/KernSur.html'>GenKern::KernSur()</a></code>, <code><a href='rings-prevR-method.html'>rings()</a></code>, <code><a href='Noptim.html'>Noptim()</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
  <span class='no'>dhs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rings-prevR-method.html'>rings</a></span>(<span class='no'>fdhs</span>, <span class='kw'>N</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>,<span class='fl'>200</span>,<span class='fl'>300</span>,<span class='fl'>400</span>,<span class='fl'>500</span>))

  <span class='no'>prev.N300</span> <span class='kw'>&lt;-</span> <span class='fu'>kde</span>(<span class='no'>dhs</span>, <span class='kw'>N</span><span class='kw'>=</span><span class='fl'>300</span>, <span class='kw'>nb.cells</span><span class='kw'>=</span><span class='fl'>200</span>)

  <span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>sp</span>)
  <span class='fu'><a href='https://rdrr.io/pkg/sp/man/spplot.html'>spplot</a></span>(<span class='no'>prev.N300</span>, <span class='st'>'k.wprev.N300.RInf'</span>,
         <span class='kw'>cuts</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='prevR.colors.html'>prevR.colors.red</a></span>(<span class='fl'>101</span>),
         <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Regional trends of prevalence (N=300)"</span>
  )

  <span class='no'>prev.krige</span> <span class='kw'>&lt;-</span> <span class='fu'>kde</span>(<span class='no'>dhs</span>, <span class='kw'>N</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>,<span class='fl'>300</span>,<span class='fl'>500</span>), <span class='kw'>R</span><span class='kw'>=</span><span class='fl'>Inf</span>,
                    <span class='kw'>nb.cells</span><span class='kw'>=</span><span class='fl'>200</span>, <span class='kw'>risk.ratio</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>keep.details</span><span class='kw'>=</span><span class='fl'>FALSE</span>
  )
  <span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>prev.krige</span>)
  <span class='fu'><a href='https://rdrr.io/pkg/sp/man/spplot.html'>spplot</a></span>(<span class='no'>prev.krige</span>,
         <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>'k.wprev.N100.RInf'</span>,<span class='st'>'k.wprev.N300.RInf'</span>,<span class='st'>'k.wprev.N500.RInf'</span>),
         <span class='kw'>cuts</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>col.regions</span><span class='kw'>=</span><span class='fu'><a href='prevR.colors.html'>prevR.colors.red</a></span>(<span class='fl'>101</span>)
  )
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joseph Larmarange.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


