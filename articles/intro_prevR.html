<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to prevR • prevR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to prevR">
<meta property="og:description" content="prevR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prevR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro_prevR.html">Introduction to prevR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/larmarange/prevR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="intro_prevR_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to prevR</h1>
                        <h4 class="author">Joseph Larmarange</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/larmarange/prevR/blob/master/vignettes/intro_prevR.Rmd"><code>vignettes/intro_prevR.Rmd</code></a></small>
      <div class="hidden name"><code>intro_prevR.Rmd</code></div>

    </div>

    
    
<p>This package performs a methodological approach for spatial estimation of regional trends of a prevalence using data from surveys using a stratified two-stage sample design (as Demographic and Health Surveys). In these kind of surveys, positive and control cases are spatially positioned at the centre of their corresponding surveyed cluster.</p>
<p>This package provides functions to estimate a prevalence surface using a kernel estimator with adaptative bandwiths of equal number of persons surveyed (a variant of the nearest neighbour technique) or with fixed bandwiths. The prevalence surface could also be calculated using a spatial interpolation (kriging or inverse distance weighting) after a moving average smoothing based on circles of equal number of observed persons or circles of equal radius.</p>
<p>With the kernel estimator approach, it’s also possible to estimate a surface of relative risks.</p>
<p>The methodological approach has been described in:</p>
<ul>
<li>Larmarange Joseph, Vallo Roselyne, Yaro Seydou, Msellati Philippe and Meda Nicolas (2011) “Methods for mapping regional trends of HIV prevalence from Demographic and Health Surveys (DHS)”, <em>Cybergeo: European Journal of Geography</em>, no 558, <a href="https://journals.openedition.org/cybergeo/24606" class="uri">https://journals.openedition.org/cybergeo/24606</a>, DOI: 10.4000/cybergeo.24606</li>
</ul>
<p>Application to generate HIV prevalence surfaces can be found at:</p>
<ul>
<li>Larmarange Joseph and Bendaud Victoria (2014) “HIV estimates at second subnational level from national population-based survey”, AIDS, n° 28, p. S469-S476, DOI: 10.1097/QAD.0000000000000480</li>
</ul>
<p>Other papers using <strong>prevR</strong> could be found on <a href="https://scholar.google.fr/scholar?oi=bibs&amp;hl=fr&amp;cites=1938663060375810997,6018660907435103505">Google Scholar</a>.</p>
<div id="importing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#importing-data" class="anchor"></a>Importing data</h2>
<p>To create a <strong>prevR</strong> object, you need three elements:</p>
<ul>
<li>a data.frame with one row per survey cluster and containing the number of observations, the number of positive cases and coordinates of the cluster (you could optionnaly use weighted numbers)</li>
<li>a vector identifying the columns of the data.frame containing the correspondant variables</li>
<li>an optional <code>SpatialPolygons</code> defining the studied area</li>
</ul>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">prevR</span>, <span class="kw">quietly</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<pre><code>## 
## 
## Welcome to 'prevR': estimate regional trends of a prevalence.</code></pre>
<pre><code>##  - type help('prevR') for details
##  - type demo(prevR) for a demonstration
##  - type citation('prevR') to cite prevR in a publication.
## 
## </code></pre>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">col</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"cluster"</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="st">"x"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"y"</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pos</span> <span class="kw">=</span> <span class="st">"pos"</span>, <span class="kw">c.type</span> <span class="kw">=</span> <span class="st">"residence"</span>, <span class="kw">wn</span> <span class="kw">=</span> <span class="st">"weighted.n"</span>, <span class="kw">wpos</span> <span class="kw">=</span> <span class="st">"weighted.pos"</span>)
<span class="no">dhs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/as.prevR.html">as.prevR</a></span>(<span class="no">fdhs.clusters</span>, <span class="no">col</span>, <span class="no">fdhs.boundary</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">dhs</span>)</pre></body></html></div>
<pre><code>## Formal class 'prevR' [package "prevR"] with 4 slots
##   ..@ clusters:'data.frame': 401 obs. of  10 variables:
##   .. ..$ id    : int [1:401] 1 10 100 101 102 103 104 105 106 107 ...
##   .. ..$ x     : num [1:401] -1.21 -1.79 -2.29 -2.71 -1.96 ...
##   .. ..$ y     : num [1:401] 7.29 6.13 5.96 6.04 5.12 ...
##   .. ..$ n     : num [1:401] 23 22 22 28 21 21 11 24 23 15 ...
##   .. ..$ pos   : num [1:401] 0 0 0 0 3 4 0 1 0 0 ...
##   .. ..$ c.type: Factor w/ 2 levels "Rural","Urban": 1 1 1 1 1 1 1 1 1 1 ...
##   .. ..$ wn    : num [1:401] 19.8 19.8 20.2 20.2 20.2 ...
##   .. ..$ wpos  : num [1:401] 0 0 0 0 2.88 ...
##   .. ..$ prev  : num [1:401] 0 0 0 0 14.3 ...
##   .. ..$ wprev : num [1:401] 0 0 0 0 14.3 ...
##   ..@ boundary:Formal class 'SpatialPolygons' [package "sp"] with 4 slots
##   .. .. ..@ polygons   :List of 1
##   .. .. .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
##   .. .. .. .. .. ..@ Polygons :List of 1
##   .. .. .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
##   .. .. .. .. .. .. .. .. ..@ labpt  : num [1:2] -0.794 10.172
##   .. .. .. .. .. .. .. .. ..@ area   : num 51.9
##   .. .. .. .. .. .. .. .. ..@ hole   : logi FALSE
##   .. .. .. .. .. .. .. .. ..@ ringDir: int 1
##   .. .. .. .. .. .. .. .. ..@ coords : num [1:4056, 1:2] 1.28 1.25 1.23 1.22 1.22 ...
##   .. .. .. .. .. ..@ plotOrder: int 1
##   .. .. .. .. .. ..@ labpt    : num [1:2] -0.794 10.172
##   .. .. .. .. .. ..@ ID       : chr "P1"
##   .. .. .. .. .. ..@ area     : num 51.9
##   .. .. ..@ plotOrder  : int 1
##   .. .. ..@ bbox       : num [1:2, 1:2] -5.52 4.74 3.85 15.08
##   .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. ..$ : chr [1:2] "x" "y"
##   .. .. .. .. ..$ : chr [1:2] "min" "max"
##   .. .. ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slot
##   .. .. .. .. ..@ projargs: chr "+proj=longlat +datum=WGS84 +no_defs"
##   ..@ proj    :Formal class 'CRS' [package "sp"] with 1 slot
##   .. .. ..@ projargs: chr "+proj=longlat +datum=WGS84 +no_defs"
##   ..@ rings   : list()</code></pre>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/print-prevR-method.html">print</a></span>(<span class="no">dhs</span>)</pre></body></html></div>
<pre><code>## Object of class 'prevR'</code></pre>
<pre><code>## Number of clusters: 401</code></pre>
<pre><code>## Number of observations: 8000</code></pre>
<pre><code>## Number of positive cases: 810</code></pre>
<pre><code>## The dataset is weighted.</code></pre>
<pre><code>## 
## National prevalence: 10.12%</code></pre>
<pre><code>## National weighted prevalence: 10.16%</code></pre>
<pre><code>## 
## Projection used: +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre><code>## 
## Coordinate range</code></pre>
<pre><code>##        min     max
## x -5.37750  3.6850
## y  4.80326 14.1225</code></pre>
<pre><code>## 
## Boundary coordinate range</code></pre>
<pre><code>##         min       max
## x -5.518916  3.851701
## y  4.736723 15.082593</code></pre>
<p>An interactive helper function <code><a href="../reference/import.dhs.html">import.dhs()</a></code> could be used to compute statistics per cluster and to generate the <strong>prevR</strong> object for those who downloaded individual files (SPSS format) and location of clusters (dbf format) from DHS website (<a href="https://dhsprogram.com/" class="uri">https://dhsprogram.com/</a>).</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">imported_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/import.dhs.html">import.dhs</a></span>(<span class="st">"data.sav"</span>, <span class="st">"gps.dbf"</span>)</pre></body></html></div>
<p>Boudaries of a specific country could be obtained with <code><a href="../reference/create.boundary.html">create.boundary()</a></code>.</p>
</div>
<div id="plotting-a-prevr-object" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-a-prevr-object" class="anchor"></a>Plotting a prevR object</h2>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(<span class="no">dhs</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Clusters position"</span>)</pre></body></html></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(<span class="no">dhs</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"c.type"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Clusters by residence"</span>)</pre></body></html></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-4-2.png" width="576"></p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(<span class="no">dhs</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"count"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Observations by cluster"</span>)</pre></body></html></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-4-3.png" width="576"></p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(<span class="no">dhs</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"flower"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Positive cases by cluster"</span>)</pre></body></html></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-4-4.png" width="576"></p>
</div>
<div id="changing-coordinates-projection" class="section level2">
<h2 class="hasAnchor">
<a href="#changing-coordinates-projection" class="anchor"></a>Changing coordinates projection</h2>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(<span class="no">dhs</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">dhs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/changeproj-prevR-method.html">changeproj</a></span>(<span class="no">dhs</span>, <span class="st">"+proj=utm +zone=30 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"</span>)</pre></body></html></div>
<pre><code>## Warning in proj4string(obj): CRS object has comment, which is lost in output</code></pre>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="fu"><a href="../reference/print-prevR-method.html">print</a></span>(<span class="no">dhs</span>)</pre></body></html></div>
<pre><code>## Object of class 'prevR'</code></pre>
<pre><code>## Number of clusters: 401</code></pre>
<pre><code>## Number of observations: 8000</code></pre>
<pre><code>## Number of positive cases: 810</code></pre>
<pre><code>## The dataset is weighted.</code></pre>
<pre><code>## 
## National prevalence: 10.12%</code></pre>
<pre><code>## National weighted prevalence: 10.16%</code></pre>
<pre><code>## 
## Projection used: +proj=utm +zone=30 +datum=WGS84 +units=m +no_defs</code></pre>
<pre><code>## 
## Coordinate range</code></pre>
<pre><code>##        min     max
## x 240094.2 1231995
## y 531003.3 1562155</code></pre>
<pre><code>## 
## Boundary coordinate range</code></pre>
<pre><code>##        min     max
## x 224228.1 1251165
## y 523628.1 1669034</code></pre>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="fu"><a href="../reference/plot-prevR-missing-method.html">plot</a></span>(<span class="no">dhs</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-5-2.png" width="576"></p>
</div>
<div id="quick-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-analysis" class="anchor"></a>Quick analysis</h2>
<p>Function <code><a href="../reference/quick.prevR.html">quick.prevR()</a></code> allows to perform a quick analysis:</p>
<ul>
<li>an optimal value of <strong>N</strong> will be computed with <code><a href="../reference/Noptim.html">Noptim()</a></code>
</li>
<li>adapative bandwiths will be calculted with <code><a href="../reference/rings-prevR-method.html">rings()</a></code>
</li>
<li>a prevalence surface will be computed with <code><a href="../reference/kde-prevR-method.html">kde()</a></code>
</li>
<li>the surface of rings radii will be generated with <code><a href="../reference/krige-ANY-prevR-method.html">krige()</a></code>
</li>
<li>a <strong>ggplot2</strong> of the prevalence surface will be generated and rings radii will be added as a contour plot</li>
</ul>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu"><a href="../reference/quick.prevR.html">quick.prevR</a></span>(<span class="no">fdhs</span>)</pre></body></html></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<p>Several values of <strong>N</strong> could be specified, and several options allows you to return detailed results.</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/quick.prevR.html">quick.prevR</a></span>(<span class="no">fdhs</span>, <span class="kw">N</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span>), <span class="kw">return.results</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">return.plot</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">plot.results</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">progression</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">nb.cells</span> <span class="kw">=</span> <span class="fl">50</span>)</pre></body></html></div>
<pre><code>## Warning in proj4string(d$data): CRS object has comment, which is lost in output</code></pre>
<pre><code>## Warning in proj4string(newdata): CRS object has comment, which is lost in output

## Warning in proj4string(newdata): CRS object has comment, which is lost in output</code></pre>
<pre><code>## Warning in proj4string(d$data): CRS object has comment, which is lost in output</code></pre>
<pre><code>## Warning in proj4string(newdata): CRS object has comment, which is lost in output

## Warning in proj4string(newdata): CRS object has comment, which is lost in output</code></pre>
<pre><code>## Warning in proj4string(d$data): CRS object has comment, which is lost in output</code></pre>
<pre><code>## Warning in proj4string(newdata): CRS object has comment, which is lost in output

## Warning in proj4string(newdata): CRS object has comment, which is lost in output</code></pre>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="no">res</span>$<span class="no">plot</span></pre></body></html></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
</div>
<div id="step-by-step-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#step-by-step-analysis" class="anchor"></a>Step by step analysis</h2>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="co"># Calculating rings of the same number of observations for different values of N</span>
<span class="no">dhs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rings-prevR-method.html">rings</a></span>(<span class="no">fdhs</span>, <span class="kw">N</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span>, <span class="fl">400</span>, <span class="fl">500</span>), <span class="kw">progression</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="../reference/print-prevR-method.html">print</a></span>(<span class="no">dhs</span>)</pre></body></html></div>
<pre><code>## Object of class 'prevR'</code></pre>
<pre><code>## Number of clusters: 401</code></pre>
<pre><code>## Number of observations: 8000</code></pre>
<pre><code>## Number of positive cases: 810</code></pre>
<pre><code>## The dataset is weighted.</code></pre>
<pre><code>## 
## National prevalence: 10.12%</code></pre>
<pre><code>## National weighted prevalence: 10.16%</code></pre>
<pre><code>## 
## Projection used: +proj=longlat +datum=WGS84 +no_defs</code></pre>
<pre><code>## 
## Coordinate range</code></pre>
<pre><code>##        min     max
## x -5.37750  3.6850
## y  4.80326 14.1225</code></pre>
<pre><code>## 
## Boundary coordinate range</code></pre>
<pre><code>##         min       max
## x -5.518916  3.851701
## y  4.736723 15.082593</code></pre>
<pre><code>## 
## Available (N,R) couples in the slot 'rings':</code></pre>
<pre><code>##    N   R
##  100 Inf
##  200 Inf
##  300 Inf
##  400 Inf
##  500 Inf</code></pre>
<div class="sourceCode" id="cb65"><html><body><pre class="r"><span class="fu"><a href="../reference/summary-prevR-method.html">summary</a></span>(<span class="no">dhs</span>)</pre></body></html></div>
<pre><code>## Object of class 'prevR'</code></pre>
<pre><code>## SLOT CLUSTERS</code></pre>
<pre><code>##        x                 y                n              pos         c.type   
##  Min.   :-5.3775   Min.   : 4.803   Min.   : 8.00   Min.   :0.00   Rural:230  
##  1st Qu.:-1.7925   1st Qu.: 6.375   1st Qu.:17.00   1st Qu.:0.00   Urban:171  
##  Median :-0.7650   Median : 7.455   Median :20.00   Median :2.00              
##  Mean   :-0.6605   Mean   : 8.647   Mean   :19.95   Mean   :2.02              
##  3rd Qu.: 0.1590   3rd Qu.:11.205   3rd Qu.:23.00   3rd Qu.:3.00              
##  Max.   : 3.6850   Max.   :14.123   Max.   :31.00   Max.   :9.00              
##        wn             wpos            prev            wprev       
##  Min.   :18.58   Min.   :0.000   Min.   : 0.000   Min.   : 0.000  
##  1st Qu.:19.84   1st Qu.:0.000   1st Qu.: 0.000   1st Qu.: 0.000  
##  Median :20.04   Median :1.544   Median : 7.692   Median : 7.692  
##  Mean   :19.95   Mean   :2.027   Mean   :10.143   Mean   :10.143  
##  3rd Qu.:20.12   3rd Qu.:3.166   3rd Qu.:15.789   3rd Qu.:15.789  
##  Max.   :21.76   Max.   :8.806   Max.   :43.750   Max.   :43.750</code></pre>
<pre><code>## 
## SLOT RINGS FOR N=100 AND R=Inf</code></pre>
<pre><code>##      r.pos            r.n            r.prev          r.radius      
##  Min.   : 0.00   Min.   :100.0   Min.   : 0.000   Min.   :  4.155  
##  1st Qu.: 4.00   1st Qu.:105.0   1st Qu.: 4.000   1st Qu.: 23.046  
##  Median :11.00   Median :110.0   Median : 9.483   Median : 37.853  
##  Mean   :11.63   Mean   :110.7   Mean   :10.550   Mean   : 42.219  
##  3rd Qu.:18.00   3rd Qu.:115.0   3rd Qu.:15.789   3rd Qu.: 57.861  
##  Max.   :32.00   Max.   :127.0   Max.   :27.586   Max.   :142.042  
##    r.clusters        r.wpos            r.wn           r.wprev      
##  Min.   :4.000   Min.   : 0.000   Min.   : 79.76   Min.   : 0.000  
##  1st Qu.:5.000   1st Qu.: 4.515   1st Qu.:100.25   1st Qu.: 3.895  
##  Median :6.000   Median :11.175   Median :118.70   Median : 9.551  
##  Mean   :5.591   Mean   :11.792   Mean   :111.52   Mean   :10.684  
##  3rd Qu.:6.000   3rd Qu.:17.256   3rd Qu.:120.13   3rd Qu.:15.735  
##  Max.   :7.000   Max.   :33.937   Max.   :140.88   Max.   :28.210</code></pre>
<pre><code>## 
## SLOT RINGS FOR N=200 AND R=Inf</code></pre>
<pre><code>##      r.pos            r.n            r.prev           r.radius      
##  Min.   : 2.00   Min.   :200.0   Min.   : 0.8929   Min.   :  7.171  
##  1st Qu.: 9.00   1st Qu.:206.0   1st Qu.: 4.3902   1st Qu.: 37.579  
##  Median :22.00   Median :211.0   Median :10.2804   Median : 58.657  
##  Mean   :22.55   Mean   :210.8   Mean   :10.7053   Mean   : 64.005  
##  3rd Qu.:33.00   3rd Qu.:216.0   3rd Qu.:15.4229   3rd Qu.: 89.381  
##  Max.   :56.00   Max.   :226.0   Max.   :26.2136   Max.   :231.980  
##    r.clusters        r.wpos           r.wn          r.wprev      
##  Min.   : 9.00   Min.   : 2.47   Min.   :175.0   Min.   : 1.030  
##  1st Qu.:10.00   1st Qu.:10.50   1st Qu.:199.8   1st Qu.: 4.563  
##  Median :11.00   Median :22.30   Median :217.3   Median :10.485  
##  Mean   :10.53   Mean   :22.66   Mean   :210.0   Mean   :10.824  
##  3rd Qu.:11.00   3rd Qu.:31.98   3rd Qu.:220.0   3rd Qu.:15.797  
##  Max.   :12.00   Max.   :53.47   Max.   :241.0   Max.   :26.666</code></pre>
<pre><code>## 
## SLOT RINGS FOR N=300 AND R=Inf</code></pre>
<pre><code>##      r.pos            r.n            r.prev          r.radius      
##  Min.   : 5.00   Min.   :300.0   Min.   : 1.587   Min.   :  9.971  
##  1st Qu.:15.00   1st Qu.:304.0   1st Qu.: 4.983   1st Qu.: 45.750  
##  Median :32.00   Median :310.0   Median :10.559   Median : 73.931  
##  Mean   :33.37   Mean   :309.8   Mean   :10.764   Mean   : 79.767  
##  3rd Qu.:47.00   3rd Qu.:315.0   3rd Qu.:15.142   3rd Qu.:108.783  
##  Max.   :78.00   Max.   :327.0   Max.   :24.759   Max.   :268.172  
##    r.clusters        r.wpos            r.wn          r.wprev      
##  Min.   :13.00   Min.   : 4.284   Min.   :260.6   Min.   : 1.532  
##  1st Qu.:15.00   1st Qu.:15.937   1st Qu.:299.2   1st Qu.: 5.080  
##  Median :15.00   Median :33.525   Median :301.8   Median :10.319  
##  Mean   :15.44   Mean   :33.297   Mean   :307.9   Mean   :10.853  
##  3rd Qu.:16.00   3rd Qu.:46.856   3rd Qu.:320.0   3rd Qu.:15.429  
##  Max.   :17.00   Max.   :76.990   Max.   :341.4   Max.   :25.273</code></pre>
<pre><code>## 
## SLOT RINGS FOR N=400 AND R=Inf</code></pre>
<pre><code>##      r.pos            r.n            r.prev          r.radius     
##  Min.   : 8.00   Min.   :400.0   Min.   : 2.000   Min.   : 12.70  
##  1st Qu.:22.00   1st Qu.:405.0   1st Qu.: 5.327   1st Qu.: 54.42  
##  Median :44.00   Median :410.0   Median :10.602   Median : 85.41  
##  Mean   :44.18   Mean   :410.3   Mean   :10.764   Mean   : 94.79  
##  3rd Qu.:58.00   3rd Qu.:415.0   3rd Qu.:14.217   3rd Qu.:127.73  
##  Max.   :98.00   Max.   :427.0   Max.   :23.278   Max.   :293.64  
##    r.clusters        r.wpos            r.wn          r.wprev      
##  Min.   :18.00   Min.   : 8.229   Min.   :360.1   Min.   : 2.045  
##  1st Qu.:20.00   1st Qu.:22.358   1st Qu.:399.9   1st Qu.: 5.345  
##  Median :21.00   Median :43.851   Median :415.4   Median :10.315  
##  Mean   :20.54   Mean   :44.298   Mean   :409.6   Mean   :10.851  
##  3rd Qu.:21.00   3rd Qu.:58.963   3rd Qu.:421.0   3rd Qu.:14.341  
##  Max.   :22.00   Max.   :95.591   Max.   :443.4   Max.   :23.452</code></pre>
<pre><code>## 
## SLOT RINGS FOR N=500 AND R=Inf</code></pre>
<pre><code>##      r.pos             r.n            r.prev          r.radius     
##  Min.   : 14.00   Min.   :500.0   Min.   : 2.783   Min.   : 16.38  
##  1st Qu.: 31.00   1st Qu.:505.0   1st Qu.: 6.163   1st Qu.: 67.01  
##  Median : 54.00   Median :510.0   Median :10.700   Median : 98.47  
##  Mean   : 55.24   Mean   :510.3   Mean   :10.811   Mean   :107.68  
##  3rd Qu.: 70.00   3rd Qu.:515.0   3rd Qu.:13.699   3rd Qu.:140.71  
##  Max.   :116.00   Max.   :528.0   Max.   :22.612   Max.   :347.09  
##    r.clusters        r.wpos            r.wn          r.wprev      
##  Min.   :23.00   Min.   : 12.93   Min.   :455.7   Min.   : 2.499  
##  1st Qu.:25.00   1st Qu.: 31.71   1st Qu.:499.5   1st Qu.: 6.138  
##  Median :26.00   Median : 51.91   Median :510.9   Median :10.222  
##  Mean   :25.53   Mean   : 55.12   Mean   :509.3   Mean   :10.869  
##  3rd Qu.:26.00   3rd Qu.: 70.17   3rd Qu.:520.8   3rd Qu.:13.929  
##  Max.   :28.00   Max.   :110.78   Max.   :555.8   Max.   :22.822</code></pre>
<pre><code>## 
## QUANTILES OF r.radius (in kilometers):</code></pre>
<pre><code>##              0%   10%   25%   50%    75%    80%    90%    95%    99%   100%
## N100.RInf  4.15  7.84 23.05 37.85  57.86  62.99  79.63  93.12 121.77 142.04
## N200.RInf  7.17 14.58 37.58 58.66  89.38  94.40 114.97 134.81 173.37 231.98
## N300.RInf  9.97 18.75 45.75 73.93 108.78 114.65 138.17 159.10 211.31 268.17
## N400.RInf 12.70 31.42 54.42 85.41 127.73 136.67 163.91 177.11 241.44 293.64
## N500.RInf 16.38 41.15 67.01 98.47 140.71 156.53 181.92 201.87 286.18 347.09</code></pre>
<div class="sourceCode" id="cb81"><html><body><pre class="r"><span class="co"># Prevalence surface for N=300</span>
<span class="no">prev.N300</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/kde-prevR-method.html">kde</a></span>(<span class="no">dhs</span>, <span class="kw">N</span> <span class="kw">=</span> <span class="fl">300</span>, <span class="kw">nb.cells</span> <span class="kw">=</span> <span class="fl">200</span>, <span class="kw">progression</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sp</span>)
<span class="fu"><a href="https://rdrr.io/pkg/sp/man/spplot.html">spplot</a></span>(<span class="no">prev.N300</span>, <span class="st">"k.wprev.N300.RInf"</span>, <span class="kw">cuts</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">col.regions</span> <span class="kw">=</span> <span class="fu"><a href="../reference/prevR.colors.html">prevR.colors.red</a></span>(<span class="fl">101</span>), <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Regional trends of prevalence (N=300)"</span>)</pre></body></html></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<div class="sourceCode" id="cb82"><html><body><pre class="r"><span class="co"># Surface of rings' radius</span>
<span class="no">radius.N300</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/krige-ANY-prevR-method.html">krige</a></span>(<span class="st">"r.radius"</span>, <span class="no">dhs</span>, <span class="kw">N</span> <span class="kw">=</span> <span class="fl">300</span>, <span class="kw">nb.cells</span> <span class="kw">=</span> <span class="fl">200</span>)</pre></body></html></div>
<pre><code>## Warning in proj4string(d$data): CRS object has comment, which is lost in output</code></pre>
<pre><code>## Warning in proj4string(newdata): CRS object has comment, which is lost in output</code></pre>
<pre><code>## [using ordinary kriging]</code></pre>
<pre><code>## Warning in proj4string(newdata): CRS object has comment, which is lost in output</code></pre>
<div class="sourceCode" id="cb87"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spplot.html">spplot</a></span>(<span class="no">radius.N300</span>, <span class="kw">cuts</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">col.regions</span> <span class="kw">=</span> <span class="fu"><a href="../reference/prevR.colors.html">prevR.colors.blue</a></span>(<span class="fl">101</span>), <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Radius of circle (N=300)"</span>)</pre></body></html></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-10-2.png" width="576"></p>
<div class="sourceCode" id="cb88"><html><body><pre class="r"><span class="co"># ggplot2 graph</span>
<span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/as.data.frame.prevR.html">as.data.frame</a></span>(<span class="no">prev.N300</span>)
<span class="no">res</span> <span class="kw">&lt;-</span> <span class="no">res</span>[!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">res</span>$<span class="no">k.wprev.N300.RInf</span>), ]
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">res</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">k.wprev.N300.RInf</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span>(<span class="kw">colours</span><span class="kw">=</span><span class="fu"><a href="../reference/prevR.colors.html">prevR.colors.red</a></span>(<span class="fl">20</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span>() +
  <span class="fu"><a href="../reference/theme_prevR.html">theme_prevR_light</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="st">"Prevalence (%)"</span>)</pre></body></html></div>
<p><img src="intro_prevR_files/figure-html/unnamed-chunk-10-3.png" width="576"></p>
</div>
<div id="functions-and-methods-provided-by-prevr" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-and-methods-provided-by-prevr" class="anchor"></a>Functions and methods provided by prevR</h2>
<p>The content of <strong>prevR</strong> can be broken up as follows:</p>
<div id="datasets" class="section level3">
<h3 class="hasAnchor">
<a href="#datasets" class="anchor"></a>Datasets</h3>
<ul>
<li>
<code>fdhs</code> is a fictive dataset used for testing the package.</li>
<li>
<code>TMWorldBorders</code> provides national borders of every countries in the World and could be used to define the limits of the studied area.</li>
</ul>
</div>
<div id="creating-objects" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-objects" class="anchor"></a>Creating objects</h3>
<p>prevR functions takes as input ojects of class prevR.</p>
<ul>
<li>
<code><a href="../reference/import.dhs.html">import.dhs()</a></code> allows to import easily, through a step by step procedure, data from a DHS (Demographic and Health Surveys) downloaded from <a href="http://www.measuredhs.com" class="uri">http://www.measuredhs.com</a>.</li>
<li>
<code><a href="../reference/as.prevR.html">as.prevR()</a></code> is a generic function to create an object of class prevR.</li>
<li>
<code><a href="../reference/create.boundary.html">create.boundary()</a></code> could be used to select borders of a country and transfer them to as.prevR in order to define the studied area.</li>
</ul>
</div>
<div id="data-visualisation" class="section level3">
<h3 class="hasAnchor">
<a href="#data-visualisation" class="anchor"></a>Data visualisation</h3>
<ul>
<li>Methods <code><a href="../reference/show-prevR-method.html">show()</a></code>, <code><a href="../reference/print-prevR-method.html">print()</a></code> and <code><a href="../reference/summary-prevR-method.html">summary()</a></code> display a summary of a object of class prevR.</li>
<li>The method <code><a href="../reference/plot-prevR-missing-method.html">plot()</a></code> could be used on a object of class prevR for visualising the studied area, spatial position of clusters, number of observations or number of positive cases by cluster.</li>
</ul>
</div>
<div id="data-manipulation" class="section level3">
<h3 class="hasAnchor">
<a href="#data-manipulation" class="anchor"></a>Data manipulation</h3>
<ul>
<li>The method <code><a href="../reference/changeproj-prevR-method.html">changeproj()</a></code> changes the projection of the spatial coordinates.</li>
<li>The method <code><a href="../reference/as.data.frame.prevR.html">as.data.frame()</a></code> converts an object of class prevR into a data frame.</li>
<li>The method <code><a href="../reference/export-prevR-method.html">export()</a></code> export data and/or the studied area in a text file, a dbf file or a shapefile.</li>
</ul>
</div>
<div id="data-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#data-analysis" class="anchor"></a>Data analysis</h3>
<ul>
<li>
<code><a href="../reference/rings-prevR-method.html">rings()</a></code> calculates rings of equal number of observations and/or equal radius.</li>
<li>
<code><a href="../reference/kde-prevR-method.html">kde()</a></code> calculates a prevalence surface or a relative risks surface using gaussian kernel density estimators (kde) with adaptative bandwiths.</li>
<li>
<code><a href="../reference/krige-ANY-prevR-method.html">krige()</a></code> executes a spatial interpolation using an ordinary kriging.</li>
<li>
<code><a href="../reference/krige-ANY-prevR-method.html">idw()</a></code> executes a spatial interpolation using an inverse distance weighting (idw) technique.</li>
</ul>
</div>
<div id="results-visualisation-and-export" class="section level3">
<h3 class="hasAnchor">
<a href="#results-visualisation-and-export" class="anchor"></a>Results visualisation and export</h3>
<ul>
<li>Outputs of <code><a href="../reference/kde-prevR-method.html">kde()</a></code>, <code><a href="../reference/krige-ANY-prevR-method.html">krige()</a></code> and <code><a href="../reference/krige-ANY-prevR-method.html">idw()</a></code> are objects of class <code>SpatialPixelsDataFrame</code> (<strong>sp</strong> package).</li>
<li>Results could be plotted using the function <code><a href="https://rdrr.io/pkg/sp/man/spplot.html">spplot()</a></code> from <strong>sp</strong>.</li>
<li>prevR provides several continuous color palettes (see <code>prevR.colors</code>) compatible with <code><a href="https://rdrr.io/pkg/sp/man/spplot.html">spplot()</a></code>.</li>
<li>Calculated surfaces could be export using the function <code>writeAsciiGrid()</code> from <strong>maptools</strong>.</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joseph Larmarange.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
