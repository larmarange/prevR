<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Spatial interpolation (kriging and inverse distance weighting) for objects
of class prevR. — krige,ANY,prevR-method • prevR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial interpolation (kriging and inverse distance weighting) for objects
of class prevR. — krige,ANY,prevR-method"><meta property="og:description" content="These functions execute a spatial interpolation of a variable of the slot
rings of an object of class prevR. The method krige()
implements the ordinary kriging technique. The method idw() executes
an inverse distance weighting interpolation."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prevR</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">5.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/intro_prevR.html">Introduction to prevR</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/larmarange/prevR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial interpolation (kriging and inverse distance weighting) for objects
of class prevR.</h1>
    <small class="dont-index">Source: <a href="https://github.com/larmarange/prevR/blob/HEAD/R/krige.prevR.r" class="external-link"><code>R/krige.prevR.r</code></a></small>
    <div class="hidden name"><code>krige-ANY-prevR-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions execute a spatial interpolation of a variable of the slot
<code>rings</code> of an object of class <a href="prevR-class.html">prevR</a>. The method <code>krige()</code>
implements the ordinary kriging technique. The method <code>idw()</code> executes
an inverse distance weighting interpolation.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for ANY,prevR</span></span>
<span><span class="fu">krige</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">locations</span>,</span>
<span>  N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  R <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nb.cells <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  cell.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fit <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  keep.variance <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.variogram <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ANY,prevR</span></span>
<span><span class="fu">idw</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">locations</span>,</span>
<span>  N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  R <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  nb.cells <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  cell.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  idp <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>variable(s) to interpolate (see details).</p></dd>


<dt>locations</dt>
<dd><p>object of class <a href="prevR-class.html">prevR</a>.</p></dd>


<dt>N</dt>
<dd><p>integer or list of integers corresponding to the rings to use.</p></dd>


<dt>R</dt>
<dd><p>integer or list of integers corresponding to the rings to use.</p></dd>


<dt>model</dt>
<dd><p>a variogram model returned by the function <code><a href="https://rdrr.io/pkg/gstat/man/vgm.html" class="external-link">gstat::vgm()</a></code>.</p></dd>


<dt>nb.cells</dt>
<dd><p>number of cells on the longest side of the studied area
(unused if <code>cell.size</code> is defined).</p></dd>


<dt>cell.size</dt>
<dd><p>size of each cell (in the unit of the projection).</p></dd>


<dt>fit</dt>
<dd><p><code>"auto"</code> for using a variogram automatically fitted from the data,
only if <code>model</code> is not defined (<code>NULL</code>).</p></dd>


<dt>keep.variance</dt>
<dd><p>return variance of estimates?</p></dd>


<dt>show.variogram</dt>
<dd><p>plot the variogram?</p></dd>


<dt>...</dt>
<dd><p>additional arguments transmitted to <code><a href="https://rdrr.io/pkg/gstat/man/krige.html" class="external-link">gstat::krige()</a></code>
or <code><a href="https://rdrr.io/pkg/gstat/man/krige.html" class="external-link">gstat::idw()</a></code>.</p></dd>


<dt>idp</dt>
<dd><p>inverse distance weighting power (see <code><a href="https://rdrr.io/pkg/gstat/man/krige.html" class="external-link">gstat::idw()</a></code>).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Object of class <a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf::sf</a>.
The name of estimated surfaces depends on the name of the interpolated
variable, N and R (for example: <em>r.radius.N300.RInf</em>).
If you ask the function to return variance (<code>keep.variance=TRUE</code>),
corresponding surfaces names will have the suffix <em>.var</em>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>formula</code> specifies the variable(s) to interpolate. Only variables
available in the slot <code>rings</code> of <code>locations</code> could be used. Possible values
are <code>"r.pos"</code>, <code>"r.n"</code>, <code>"r.prev"</code>, <code>"r.radius"</code>, <code>"r.clusters"</code>, <code>"r.wpos"</code>,
<code>"r.wn"</code> or <code>"r.wprev"</code>. Variables could be specified with a character
string or a formula (example: <code>list(r.pos ~ 1, r.prev ~ 1}</code>. Only formula
like <code>variable.name ~ 1</code> are accepted. For more complex interpolations,
use directly functions <code><a href="https://rdrr.io/pkg/gstat/man/krige.html" class="external-link">gstat::krige()</a></code> and <code><a href="https://rdrr.io/pkg/gstat/man/krige.html" class="external-link">gstat::idw()</a></code> from <span class="pkg">gstat</span>.</p>
<p><code>N</code> and <code>R</code> determine the rings to use for the interpolation. If they are
not defined, surfaces will be estimated for each available couples (N,R).
Several interpolations could be simultaneously calculated if several
variables and/or several values of N and R are defined.</p>
<p>A suggested value of N could be computed with <code><a href="Noptim.html">Noptim()</a></code>.</p>
<p>In the case of an ordinary kriging, the method <code>krige()</code> from <span class="pkg">prevR</span>
will try to fit automatically a exponential variogram to the sample variogram
(<code>fit = "auto"</code>). You can also specify directly the variogram to use with
the parameter <code>model</code>.</p>
<p>Interpolations are calculated on a spatial grid obtained with
<code><a href="make.grid.prevR.html">make.grid.prevR()</a></code>.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Results could be plotted with <code><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">sf::plot()</a></code> or with <span class="pkg">ggplot2</span>
using <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::geom_sf()</a></code>. See examples.</p>
<p><span class="pkg">prevR</span> provides several continuous color palettes
(see <a href="prevR.colors.html">prevR.colors</a>).</p>
<p>Results could be turned into a <span class="pkg">stars</span> raster using
<code><a href="https://r-spatial.github.io/stars/reference/st_rasterize.html" class="external-link">stars::st_rasterize()</a></code>.</p>
<p>To export to ASCII grid, rasterize the results with <code><a href="https://r-spatial.github.io/stars/reference/st_rasterize.html" class="external-link">stars::st_rasterize()</a></code>,
convert to <code>SpatRast</code> with <code><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">terra::rast()</a></code>, extract the desired layer with
<code>[[]]</code> and then use <code><a href="https://rdrr.io/pkg/terra/man/writeRaster.html" class="external-link">terra::writeRaster()</a></code>. See examples.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Larmarange Joseph, Vallo Roselyne, Yaro Seydou, Msellati Philippe and Meda
Nicolas (2011) "Methods for mapping regional trends of HIV prevalence from
Demographic and Health Surveys (DHS)",
<em>Cybergeo: European Journal of Geography</em>, no 558,
<a href="https://journals.openedition.org/cybergeo/24606" class="external-link">https://journals.openedition.org/cybergeo/24606</a>,
DOI: 10.4000/cybergeo.24606.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/gstat/man/krige.html" class="external-link">gstat::krige()</a></code>, <code><a href="https://rdrr.io/pkg/gstat/man/krige.html" class="external-link">gstat::idw()</a></code>, <code><a href="rings-prevR-method.html">rings()</a></code>, <code><a href="Noptim.html">Noptim()</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">dhs</span> <span class="op">&lt;-</span> <span class="fu"><a href="rings-prevR-method.html">rings</a></span><span class="op">(</span><span class="va">fdhs</span>, N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">200</span>,<span class="fl">300</span>,<span class="fl">400</span>,<span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">radius.N300</span> <span class="op">&lt;-</span> <span class="fu">krige</span><span class="op">(</span><span class="st">'r.radius'</span>, <span class="va">dhs</span>, N <span class="op">=</span> <span class="fl">300</span>, nb.cells <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">prev.krige</span> <span class="op">&lt;-</span> <span class="fu">krige</span><span class="op">(</span><span class="va">r.wprev</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">dhs</span>, N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">300</span>, <span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="plot-prevR-missing-method.html">plot</a></span><span class="op">(</span><span class="va">prev.krige</span>, lty <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">prev.krige</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">r.wprev.N300.RInf</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="prevR.colors.html">prevR.colors.red</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="theme_prevR.html">theme_prevR_light</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># Export r.wprev.N300.RInf surface in ASCII Grid</span></span></span>
<span class="r-in"><span>    <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu">stars</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_rasterize.html" class="external-link">st_rasterize</a></span><span class="op">(</span><span class="va">prev.krige</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># writeRaster(r[[2]], "wprev.N300.asc")</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://joseph.larmarange.net/" class="external-link">Joseph Larmarange</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

