<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spatial interpolation (kriging and inverse distance weighting) for objects of class prevR. — krige,ANY,prevR-method • prevR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spatial interpolation (kriging and inverse distance weighting) for objects of class prevR. — krige,ANY,prevR-method"><meta name="description" content="These functions execute a spatial interpolation of a variable of the slot
rings of an object of class prevR. The method krige()
implements the ordinary kriging technique. The method idw() executes
an inverse distance weighting interpolation."><meta property="og:description" content="These functions execute a spatial interpolation of a variable of the slot
rings of an object of class prevR. The method krige()
implements the ordinary kriging technique. The method idw() executes
an inverse distance weighting interpolation."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">prevR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">5.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro_prevR.html">Introduction to prevR</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/larmarange/prevR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Spatial interpolation (kriging and inverse distance weighting) for objects of class prevR.</h1>
      <small class="dont-index">Source: <a href="https://github.com/larmarange/prevR/blob/main/R/krige.prevR.r" class="external-link"><code>R/krige.prevR.r</code></a></small>
      <div class="d-none name"><code>krige-ANY-prevR-method.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions execute a spatial interpolation of a variable of the slot
<code>rings</code> of an object of class <a href="prevR-class.html">prevR</a>. The method <code>krige()</code>
implements the ordinary kriging technique. The method <code>idw()</code> executes
an inverse distance weighting interpolation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'ANY,prevR'</span></span>
<span><span class="fu">krige</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">locations</span>,</span>
<span>  N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  R <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nb.cells <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  cell.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fit <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  keep.variance <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.variogram <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'ANY,prevR'</span></span>
<span><span class="fu">idw</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">locations</span>,</span>
<span>  N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  R <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  nb.cells <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  cell.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  idp <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>variable(s) to interpolate (see details).</p></dd>


<dt id="arg-locations">locations<a class="anchor" aria-label="anchor" href="#arg-locations"></a></dt>
<dd><p>object of class <a href="prevR-class.html">prevR</a>.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>integer or list of integers corresponding to the rings to use.</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>integer or list of integers corresponding to the rings to use.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>a variogram model returned by the function <code><a href="https://r-spatial.github.io/gstat/reference/vgm.html" class="external-link">gstat::vgm()</a></code>.</p></dd>


<dt id="arg-nb-cells">nb.cells<a class="anchor" aria-label="anchor" href="#arg-nb-cells"></a></dt>
<dd><p>number of cells on the longest side of the studied area
(unused if <code>cell.size</code> is defined).</p></dd>


<dt id="arg-cell-size">cell.size<a class="anchor" aria-label="anchor" href="#arg-cell-size"></a></dt>
<dd><p>size of each cell (in the unit of the projection).</p></dd>


<dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p><code>"auto"</code> for using a variogram automatically fitted from the data,
only if <code>model</code> is not defined (<code>NULL</code>).</p></dd>


<dt id="arg-keep-variance">keep.variance<a class="anchor" aria-label="anchor" href="#arg-keep-variance"></a></dt>
<dd><p>return variance of estimates?</p></dd>


<dt id="arg-show-variogram">show.variogram<a class="anchor" aria-label="anchor" href="#arg-show-variogram"></a></dt>
<dd><p>plot the variogram?</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments transmitted to <code><a href="https://r-spatial.github.io/gstat/reference/krige.html" class="external-link">gstat::krige()</a></code>
or <code><a href="https://r-spatial.github.io/gstat/reference/krige.html" class="external-link">gstat::idw()</a></code>.</p></dd>


<dt id="arg-idp">idp<a class="anchor" aria-label="anchor" href="#arg-idp"></a></dt>
<dd><p>inverse distance weighting power (see <code><a href="https://r-spatial.github.io/gstat/reference/krige.html" class="external-link">gstat::idw()</a></code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Object of class <a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf::sf</a>.
The name of estimated surfaces depends on the name of the interpolated
variable, N and R (for example: <em>r.radius.N300.RInf</em>).
If you ask the function to return variance (<code>keep.variance=TRUE</code>),
corresponding surfaces names will have the suffix <em>.var</em>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>formula</code> specifies the variable(s) to interpolate. Only variables
available in the slot <code>rings</code> of <code>locations</code> could be used. Possible values
are <code>"r.pos"</code>, <code>"r.n"</code>, <code>"r.prev"</code>, <code>"r.radius"</code>, <code>"r.clusters"</code>, <code>"r.wpos"</code>,
<code>"r.wn"</code> or <code>"r.wprev"</code>. Variables could be specified with a character
string or a formula (example: <code>list(r.pos ~ 1, r.prev ~ 1}</code>. Only formula
like <code>variable.name ~ 1</code> are accepted. For more complex interpolations,
use directly functions <code><a href="https://r-spatial.github.io/gstat/reference/krige.html" class="external-link">gstat::krige()</a></code> and <code><a href="https://r-spatial.github.io/gstat/reference/krige.html" class="external-link">gstat::idw()</a></code> from <span class="pkg">gstat</span>.</p>
<p><code>N</code> and <code>R</code> determine the rings to use for the interpolation. If they are
not defined, surfaces will be estimated for each available couples (N,R).
Several interpolations could be simultaneously calculated if several
variables and/or several values of N and R are defined.</p>
<p>A suggested value of N could be computed with <code><a href="Noptim.html">Noptim()</a></code>.</p>
<p>In the case of an ordinary kriging, the method <code>krige()</code> from <span class="pkg">prevR</span>
will try to fit automatically a exponential variogram to the sample variogram
(<code>fit = "auto"</code>). You can also specify directly the variogram to use with
the parameter <code>model</code>.</p>
<p>Interpolations are calculated on a spatial grid obtained with
<code><a href="make.grid.prevR.html">make.grid.prevR()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Results could be plotted with <code><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">sf::plot()</a></code> or with <span class="pkg">ggplot2</span>
using <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::geom_sf()</a></code>. See examples.</p>
<p><span class="pkg">prevR</span> provides several continuous color palettes
(see <a href="prevR.colors.html">prevR.colors</a>).</p>
<p>Results could be turned into a <span class="pkg">stars</span> raster using
<code><a href="https://r-spatial.github.io/stars/reference/st_rasterize.html" class="external-link">stars::st_rasterize()</a></code>.</p>
<p>To export to ASCII grid, rasterize the results with <code><a href="https://r-spatial.github.io/stars/reference/st_rasterize.html" class="external-link">stars::st_rasterize()</a></code>,
convert to <code>SpatRast</code> with <code><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">terra::rast()</a></code>, extract the desired layer with
<code>[[]]</code> and then use <code><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">terra::writeRaster()</a></code>. See examples.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Larmarange Joseph, Vallo Roselyne, Yaro Seydou, Msellati Philippe and Meda
Nicolas (2011) "Methods for mapping regional trends of HIV prevalence from
Demographic and Health Surveys (DHS)",
<em>Cybergeo: European Journal of Geography</em>, no 558,
<a href="https://journals.openedition.org/cybergeo/24606" class="external-link">https://journals.openedition.org/cybergeo/24606</a>,
DOI: 10.4000/cybergeo.24606.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://r-spatial.github.io/gstat/reference/krige.html" class="external-link">gstat::krige()</a></code>, <code><a href="https://r-spatial.github.io/gstat/reference/krige.html" class="external-link">gstat::idw()</a></code>, <code><a href="rings-prevR-method.html">rings()</a></code>, <code><a href="Noptim.html">Noptim()</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>    <span class="va">dhs</span> <span class="op">&lt;-</span> <span class="fu"><a href="rings-prevR-method.html">rings</a></span><span class="op">(</span><span class="va">fdhs</span>, N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">200</span>,<span class="fl">300</span>,<span class="fl">400</span>,<span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">radius.N300</span> <span class="op">&lt;-</span> <span class="fu">krige</span><span class="op">(</span><span class="st">'r.radius'</span>, <span class="va">dhs</span>, N <span class="op">=</span> <span class="fl">300</span>, nb.cells <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">prev.krige</span> <span class="op">&lt;-</span> <span class="fu">krige</span><span class="op">(</span><span class="va">r.wprev</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">dhs</span>, N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">300</span>, <span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="plot-prevR-missing-method.html">plot</a></span><span class="op">(</span><span class="va">prev.krige</span>, lty <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">prev.krige</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">r.wprev.N300.RInf</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="prevR.colors.html">prevR.colors.red</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="theme_prevR.html">theme_prevR_light</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># Export r.wprev.N300.RInf surface in ASCII Grid</span></span></span>
<span class="r-in"><span>    <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu">stars</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/stars/reference/st_rasterize.html" class="external-link">st_rasterize</a></span><span class="op">(</span><span class="va">prev.krige</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># writeRaster(r[[2]], "wprev.N300.asc")</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://joseph.larmarange.net/" class="external-link">Joseph Larmarange</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

